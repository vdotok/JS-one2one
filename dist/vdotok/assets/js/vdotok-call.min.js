!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CVDOTOK=t():e.CVDOTOK=t()}(this,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=9)}([function(e,t,i){"use strict";var n,r="object"==typeof Reflect?Reflect:null,s=r&&"function"==typeof r.apply?r.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(i,n){function r(){void 0!==s&&e.removeListener("error",s),i([].slice.call(arguments))}var s;"error"!==t&&(s=function(i){e.removeListener(t,r),n(i)},e.once("error",s)),e.once(t,r)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function d(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,i,n){var r,s,o,a;if(d(i),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),s=e._events),o=s[t]),void 0===o)o=s[t]=i,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[i,o]:[o,i]:n?o.unshift(i):o.push(i),(r=l(e))>0&&o.length>r&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,a=c,console&&console.warn&&console.warn(a)}return e}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},r=p.bind(n);return r.listener=i,n.wrapFn=r,r}function h(e,t,i){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"==typeof r?i?[r.listener||r]:[r]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(r):g(r,r.length)}function m(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function g(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n="error"===e,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=r[e];if(void 0===c)return!1;if("function"==typeof c)s(c,this,t);else{var d=c.length,l=g(c,d);for(i=0;i<d;++i)s(l[i],this,t)}return!0},a.prototype.addListener=function(e,t){return u(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return u(this,e,t,!0)},a.prototype.once=function(e,t){return d(t),this.on(e,f(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return d(t),this.prependListener(e,f(this,e,t)),this},a.prototype.removeListener=function(e,t){var i,n,r,s,o;if(d(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(r=-1,s=i.length-1;s>=0;s--)if(i[s]===t||i[s].listener===t){o=i[s].listener,r=s;break}if(r<0)return this;0===r?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,r),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var r,s=Object.keys(i);for(n=0;n<s.length;++n)"removeListener"!==(r=s[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,i){"use strict";function n(e){return e instanceof Element}Object.defineProperty(t,"__esModule",{value:!0}),t.SetPlaysInline=t.IsDOM=t.GetKeyByValue=void 0,t.GetKeyByValue=function(e,t){return Object.keys(e).find(i=>e[i]===t)},t.IsDOM=n,t.SetPlaysInline=function(e){n(e)&&e.setAttribute("playsinline",!0)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(1);const r=new class{constructor(){}OnAuthError(e,t){t.emit("error",{type:"Authorization",message:"Your credentials for vidtok are invalid."+e})}OnAuthInitialError(e,t){t.emit("error",{type:"Authorization",message:"You are not connected with vidtok server."+e})}OnConnection(e,t){t.emit("connected",{type:"Success",message:"Vidtok server is connected successfully"})}OnDisconnection(e,t){t.emit("disconnected",{type:"Error",message:"Vidtok server is disconnected."+e})}OnRegister(e,t){let i=e.response;if("accepted"==i.trim())t.emit("register",{type:"REGISTER_ACCEPTED",message:"User is registered successfully"});else{let e=i.split(":")[1];e=e.trim(),t.emit("error",{type:"REGISTER_REJECTED",message:e})}}OnCallResponse(e,t){let i=e.response,n=e.from;if("accepted"==i){let i={type:"CALL_ACCEPTED",message:"Call is accepted by receiver",from:n,call_type:"one_to_one"};e.call_type&&(i.call_type=e.call_type),t.emit("call",i)}else{let i={type:"CALL_REJECTED",message:"Call is rejected by receiver",from:n,call_type:"one_to_one"};e.call_type&&(i.call_type=e.call_type),t.emit("call",i),t.DisposeWebrtc(!0)}}OnIncomingCall(e,t){let i=e.from,n=null!=e.call_type?e.call_type:"one_to_one";"many_to_many"==n?t.emit("groupCall",{type:"CALL_RECEIVED",message:"Received a call",from:i,call_type:e.media_type,session:n}):t.emit("call",{type:"CALL_RECEIVED",message:"Received a call",from:i,call_type:e.media_type,session:n})}OnIncomingGroupCall(e,t){let i=e.from,n=e.call_type;t.emit("groupCall",{type:"CALL_RECEIVED",message:"Received a call",from:i,call_type:e.media_type,session:n})}SessionStart(e,t){t.emit("call",{type:"CALL_STARTED",message:"Call is being started"})}SessionSDP(e,t){t.emit("error",{type:"PROCESS_ANSWER",message:"Unable to process remote SDP."})}OnAddCandidate(e,t){t.emit("error",{type:"CALL_ADDCANDIDATE",message:"Unable to add ice candidate."})}OnOfferIncomingCall(e,t){t.emit("error",{type:"CALL_OFFERGENERATING",message:"Unable to add generate incoming call offer."})}OnRTCPeer(e,t){t.emit("error",{type:"CALL_RTCPEER",message:"Unable to add to create webrtc peer."+e})}SessionEnd(e,t){let i=n.GetKeyByValue(t.UUIDSessions,e.sessionUUID),r=null!=e.call_type?e.call_type:"one_to_one";null!=e.responseCode&&487==e.responseCode?t.emit("call",{type:"MISSED_CALL",message:"Session canceled/Missed Call",from:i,call_type:e.media_type,session:r}):t.emit("call",{type:"CALL_ENDED",message:"Call is being ended",from:i,call_type:r})}SessionInvite(e,t){n.GetKeyByValue(t.UUIDSessions,e.sessionUUID);let i=t.UUIDSessionTypes[e.sessionUUID];if(null!=e.responseCode)switch(e.responseCode){case 100:t.emit("call",{type:"TRYING",message:"Trying to find the receiver",to:t.to,call_typ:i});break;case 180:t.emit("call",{type:"CONNECTING",message:"Trying to connect the receiver",to:t.to,call_typ:i});break;case 183:t.emit("call",{type:"ALERTING",message:"Alerting the receiver",to:t.to,call_typ:i});break;case 200:t.emit("call",{type:"CALL_ACCEPTED",message:"Call is accepted by receiver",to:t.to,call_typ:i});break;case 404:"one_to_one"==i&&t.DisposeWebrtc(!0),t.emit("call",{type:"INVALID_TARGET",message:"Receiver is not found",to:t.to,call_typ:i});break;default:"one_to_one"==i&&t.DisposeWebrtc(!0),t.emit("call",{type:"CALL_REJECTED",message:"Receiver has rejected the call",to:t.to,call_typ:i})}}SessionCancel(e,t){let i=n.GetKeyByValue(t.UUIDSessions,e.sessionUUID),r=t.UUIDSessionTypes[e.sessionUUID];if(null!=e.responseCode)switch(e.responseCode){case 487:t.emit("call",{type:"MISSED_CALL",message:"Session canceled/Missed Call",from:i,call_type:r});break;case 410:t.emit("call",{type:"PARTICIPANT_LEFT",message:"Participant has left the call",from:e.referenceID,call_typ:r});break;default:t.DisposeWebrtc(!1),t.emit("call",{type:"CALL_ENDED",message:"Call is being ended",to:t.to,call_typ:r})}}SetCallerStatus(e,t){t.emit("call",{type:"CALL_STATUS",message:"Call Status",video_status:e.videoInformation,audio_status:e.audioInformation})}SetExistingParticipants(e,t){t.emit("groupCall",{type:"PARTICIPANT_LIST",message:"Participant List is available",participant_list:e.referenceIDs})}SetParticipantStatus(e,t){t.emit("groupCall",{type:"PARTICIPANT_STATUS",message:"Participant Status",participant:e.referenceID,video_status:e.videoInformation,audio_status:e.audioInformation})}};t.default=r},function(e,t,i){var n=i(15);t.WebRtcPeer=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(12);const r=new class{constructor(){}async Authorization(e,t){let i={project_id:e,auth_token:t};return fetch(n.SERVER+"/AuthenticateSDK",{method:"POST",body:JSON.stringify(i),mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(e=>e.json()).then(e=>e).catch(e=>(console.log(e),e))}};t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(13);t.default=class{constructor(){this.RegPacket=n.default}set id(e){this.RegPacket.id=e}get id(){return this.RegPacket.id}set type(e){this.RegPacket.type=e}get type(){return this.RegPacket.type}set requestType(e){this.RegPacket.requestType=e}get requestType(){return this.RegPacket.requestType}set requestID(e){this.RegPacket.requestID=e}get requestID(){return this.RegPacket.requestID}set tenantID(e){this.RegPacket.tenantID=e}get tenantID(){return this.RegPacket.tenantID}set referenceID(e){this.RegPacket.referenceID=e}get referenceID(){return this.RegPacket.referenceID}set authorizationToken(e){this.RegPacket.authorizationToken=e}get authorizationToken(){return this.RegPacket.authorizationToken}set socketType(e){this.RegPacket.socketType=e}get socketType(){return this.RegPacket.socketType}SendRegisterRequest(e){let t=JSON.stringify(this.RegPacket);console.log("Send===RegisterRequest",t),e.send(t)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=new class{constructor(){}SetRegisterResponse(e,t){switch(e.responseCode){case 200:t.McToken=e.mcToken,t.emit("register",{type:"Success",message:"You are registered successfully with vidtok server."});break;default:t.emit("error",{type:"Register",message:"You are not registered with vidtok server."+e.responseMessage})}}};t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(14);t.default=class{constructor(){this.ReqPacket=n.default}set from(e){this.ReqPacket.from=e}get from(){return this.ReqPacket.from}set to(e){this.ReqPacket.to=e}get to(){return this.ReqPacket.to}set type(e){this.ReqPacket.type=e}get type(){return this.ReqPacket.type}set requestType(e){this.ReqPacket.requestType=e}get requestType(){return this.ReqPacket.requestType}set session_type(e){this.ReqPacket.session_type=e}get session_type(){return this.ReqPacket.session_type}set requestID(e){this.ReqPacket.requestID=e}get requestID(){return this.ReqPacket.requestID}set sessionUUID(e){this.ReqPacket.sessionUUID=e}get sessionUUID(){return this.ReqPacket.sessionUUID}set mcToken(e){this.ReqPacket.mcToken=e}get mcToken(){return this.ReqPacket.mcToken}set sdpOffer(e){this.ReqPacket.sdpOffer=e}get sdpOffer(){return this.ReqPacket.sdpOffer}set call_type(e){this.ReqPacket.call_type=e}get call_type(){return this.ReqPacket.call_type}set media_type(e){this.ReqPacket.media_type=e}get media_type(){return this.ReqPacket.media_type}SendCallRequest(e){let t=JSON.stringify(this.ReqPacket);console.log("Send===CallRequest",t),e.send(t)}}},function(e,t){var i=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(e){return null!=e.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{push:"ssrcGroups",reg:/^ssrc-group:(\w*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{push:"invalid",names:["value"]}]};Object.keys(i).forEach((function(e){i[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManyToMany=t.Confrence=t.Client=t.version=t.name=void 0;const n=i(10).LIBRARY_VERSION;t.version=n;t.name="vdotok-call";const r=i(11);t.Client=r.default;const s=i(37);t.Confrence=s.default;const o=i(38);t.ManyToMany=o.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LIBRARY_VERSION=void 0,t.LIBRARY_VERSION="0.0.1"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(2),s=i(4),o=i(5),a=i(6),c=i(7),d=i(1),l=i(3);class u extends n.EventEmitter{constructor(e){super(),this.UUIDSessions={},this.UUIDSessionTypes={},this.UUIDSessionMediaTypes={},this.projectID=e.projectID,this.projectSecret=e.secret,this.Authentication(e)}set McToken(e){this.mcToken=e}get McToken(){return this.mcToken}Authentication(e){console.log("====DER===",e,this.projectID,this.projectSecret,this.clientToken),s.default.Authorization(e.projectID,e.secret).then(e=>{if(console.log("===Authorization-outer===",e),e&&200==e.status){let t=`${e.media_server_map.protocol}://${e.media_server_map.host}:${e.media_server_map.port}/${e.media_server_map.end_point}`;this.Connect(t),console.log("===Authorization===",e)}else r.default.OnAuthError(e.message,this)})}Connect(e){var t=new WebSocket(e);t.onmessage=e=>{var t=JSON.parse(e.data);switch(console.log("Received message: ",t),t.requestType){case"register":a.default.SetRegisterResponse(t,this);break;case"callResponse":console.log(" CallResponse: ",t),this.CallResponse(t),r.default.OnCallResponse(t,this);break;case"incomingCall":this.callSession=t.sessionUUID,this.currentFromUser=t.from,this.UUIDSessions[t.from]=t.sessionUUID,this.UUIDSessionTypes[t.sessionUUID]=t.call_type,this.UUIDSessionMediaTypes[t.from]=t.media_type,console.log("incomingCall case: ",e),r.default.OnIncomingCall(t,this);break;case"startCommunication":this.SessionStart(t);break;case"stopCommunication":console.info("Communication ended by remote peer"),r.default.SessionEnd(t,this),this.DisposeWebrtc(!0);break;case"iceCandidate":this.AddCandidate(t);break;case"session_invite":r.default.SessionInvite(t,this);break;case"session_cancel":r.default.SessionCancel(t,this);break;case"state_information":console.log("===onParticipantOffer== exiting left",t,(new Date).toLocaleTimeString()),r.default.SetCallerStatus(t,this)}},t.onclose=e=>{r.default.OnDisconnection(e,this),console.log("OnClose socket==",e)},t.onopen=e=>{r.default.OnConnection(e,this),console.log("OnOpen socket==",e)},t.onerror=e=>{r.default.OnDisconnection(e,this),console.log("OnError socket==",e)},this.ws=t}AddCandidate(e){this.webRtcPeer.addIceCandidate(e.candidate,e=>{if(e)return r.default.OnAddCandidate(e,this),console.error("Error adding candidate: "+e)})}CallResponse(e){console.info("CallResponse",this.webRtcPeer,e),"accepted"==e.response&&this.webRtcPeer.processAnswer(e.sdpAnswer,e=>{if(e)return r.default.SessionSDP(e,this),console.error(e)})}SessionStart(e){r.default.SessionStart(e,this),this.webRtcPeer.processAnswer(e.sdpAnswer,e=>{if(e)return r.default.SessionSDP(e,this),console.error(e)})}AcceptCall(e,t){this.localVideo=e;let i=this.currentFromUser;var n={mediaConstraints:{audio:!0,video:"audio"!=this.UUIDSessionMediaTypes[i]},localVideo:e,remoteVideo:t,onicecandidate:e=>{this.onIceCandidate(e,i)},onerror:this.onError};this.webRtcPeer=new l.WebRtcPeer.WebRtcPeerSendrecv(n,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferIncomingCall(e,t,i)})})}RejectCall(e){let t=this.currentFromUser,i={type:"response",from:t,requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[t],responseCode:496,responseMessage:"rejected"};this.SendPacket(i),this.DisposeWebrtc(!1)}onOfferIncomingCall(e,t,i){if(e)return r.default.OnOfferIncomingCall(e,this),console.error("Error generating the offer");let n={type:"request",requestType:"session_invite",sdpOffer:t,requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[i],responseCode:200,responseMessage:"accepted"};console.log("===OnOffering Answer",n),this.SendPacket(n)}Register(e,t){this.currentUser=e;let i=new o.default;i.requestID=(new Date).getTime().toString(),i.tenantID=this.projectID,i.referenceID=e,i.authorizationToken=t,i.SendRegisterRequest(this.ws)}Call(e){this.to=Array.isArray(e.to)?e.to:[e.to],this.currentFromUser=this.currentUser,this.localVideo=e.localVideo,d.SetPlaysInline(this.localVideo);var t={localVideo:e.localVideo,remoteVideo:e.remoteVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new l.WebRtcPeer.WebRtcPeerSendrecv(t,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferCall(e,t,"video")})})}AudioCall(e){this.to=Array.isArray(e.to)?e.to:[e.to],this.currentFromUser=this.currentUser,this.localVideo=e.localVideo,d.SetPlaysInline(this.localVideo);var t={localVideo:e.localVideo,remoteVideo:e.remoteVideo,mediaConstraints:{audio:!0,video:!1},onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new l.WebRtcPeer.WebRtcPeerSendrecv(t,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferCall(e,t,"audio")})})}Broadcasting(e){this.to=e.to,this.currentFromUser=this.currentUser,this.localVideo=e.localVideo,d.SetPlaysInline(this.localVideo);var t={localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new l.WebRtcPeer.WebRtcPeerSendonly(t,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferOneToManyCall(e,t)})})}onOfferOneToManyCall(e,t){if(e)return r.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let i=(new Date).getTime().toString();this.UUIDSessions[this.currentUser]=i,this.UUIDSessionTypes[i]="one_to_many";let n=new c.default;n.from=this.currentUser,n.to=this.to,n.requestID=i,n.sessionUUID=i,n.mcToken=this.McToken,n.sdpOffer=t,n.call_type="one_to_many",n.SendCallRequest(this.ws)}AcceptBroadcast(e){let t=this.currentFromUser;d.SetPlaysInline(e);var i={remoteVideo:e,onicecandidate:e=>{this.onIceCandidate(e,t)},onerror:this.onError};this.webRtcPeer=new l.WebRtcPeer.WebRtcPeerRecvonly(i,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,i)=>{this.onOfferIncomingCall(e,i,t)})})}onOfferCall(e,t,i){if(e)return r.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let n=(new Date).getTime().toString(),s=new c.default;s.from=this.currentUser,s.to=this.to,s.requestID=n,s.sessionUUID=n,s.mcToken=this.McToken,s.sdpOffer=t,s.media_type=i,s.SendCallRequest(this.ws),this.UUIDSessions[this.currentUser]=n,this.UUIDSessionTypes[n]="one_to_one",console.log(" OnOfferCall :: :: ::",i)}DisposeWebrtc(e){if(this.webRtcPeer){if(this.webRtcPeer.dispose(),this.webRtcPeer=null,e){var t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[this.currentFromUser],mcToken:"f3101a4f686d4dd7993ded88d9e386e5"};this.SendPacket(t)}let i=this.UUIDSessions[this.currentFromUser];delete this.UUIDSessionTypes[i],delete this.UUIDSessions[this.currentFromUser]}}onError(e){r.default.OnRTCPeer(e,this)}onIceCandidate(e,t){console.log("Local candidate"+JSON.stringify(e));var i={id:"onIceCandidate",requestType:"onIceCandidate",type:"request",candidate:e,referenceID:t,sessionUUID:this.UUIDSessions[t]};this.SendPacket(i)}SendPacket(e){var t=JSON.stringify(e);console.log("Sending message: "+t),null!=this.ws?this.ws.send(t):r.default.OnAuthInitialError("",this)}EndCall(){let e=this.currentFromUser,t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[e],mcToken:this.McToken};this.SendPacket(t),this.DisposeWebrtc(!1)}CancelCall(){let e=this.currentFromUser,t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[e],mcToken:this.McToken};this.SendPacket(t),this.DisposeWebrtc(!1)}SetMicMute(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[this.currentFromUser],mcToken:this.McToken,referenceID:this.currentUser,audioInformation:0,videoInformation:1};this.SendPacket(e),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!1),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!1)}}SetMicUnmute(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[this.currentFromUser],mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:1};this.SendPacket(e),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!0),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!0)}}SetCameraOn(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[this.currentFromUser],mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:1};this.SendPacket(e),this.localVideo.srcObject.getVideoTracks()[0].enabled=!0}}SetCameraOff(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[this.currentFromUser],mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:0};this.SendPacket(e),this.localVideo.srcObject.getVideoTracks()[0].enabled=!1}}}t.default=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SERVER=void 0,t.SERVER="https://vtkapi.vdotok.com/API/v0"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={requestType:"register",type:"request",requestID:"YX9BLHSS0WLCI6ESCS2D29T5UW2YFJSY",tenantID:"12345",referenceID:"0d00e363ef75c8cc76d1ee79e950b30c",authorizationToken:"e2a10ce93bb2affbe767e843c0bfc76c",socketType:0}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={from:"User-A",to:"User-B",type:"request",requestType:"session_invite",session_type:"call",call_type:"one_to_one",media_type:"video",requestID:"UUID",sessionUUID:"sgdjkfgskjdgfs6876868",mcToken:"",sdpOffer:""}},function(e,t,i){var n=i(16),r=i(20),s=i(21),o=i(22),a=i(25),c=i(0).EventEmitter,d=i(27).recursive.bind(void 0,!0),l=i(29),u="undefined"==typeof window?console:window.Logger||console;try{i(36)}catch(e){"undefined"==typeof getScreenConstraints&&(u.warn("screen sharing is not available"),getScreenConstraints=function(e,t){t(new Error("This library is not enabled for screen sharing"))})}var p={audio:!0,video:{width:640,framerate:15}},f=new s("undefined"!=typeof window&&window.navigator?window.navigator.userAgent:"").getBrowser();"IE"===f.name&&function(e){var t=document.createElement("script");t.src=e;var i=document.querySelector("script");i.parentNode.insertBefore(t,i)}("https://cdn.temasys.io/adapterjs/0.15.x/adapter.debug.js");var h=!1;function m(e){e&&u.error(e)}function g(e){e.stop&&e.stop()}function y(e){e.getTracks().forEach(g)}"Chrome"!==f.name&&"Chromium"!==f.name||(u.debug(f.name+": using SDP PlanB"),h=!0);var v=function(e){return null==e?"":"type: "+e.type+"\r\n"+e.sdp};function w(e,t){var i=[];return function(e,t){"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?t.onsignalingstatechange=e:t.addEventListener("signalingstatechange",e)}((function(){if("stable"===e.signalingState)for(;i.length;){var t=i.shift();e.addIceCandidate(t.candidate,t.callback,t.callback)}}),e),function(n,r){switch(r=r||t,e.signalingState){case"closed":r(new Error("PeerConnection object is closed"));break;case"stable":if(e.remoteDescription){e.addIceCandidate(n,r,r);break}default:i.push({candidate:n,callback:r})}}}function b(e){var t=e.getVideoTracks();if(!t.length)return u.warn("No video tracks available in the video stream"),"";var i=["a=x-google-flag:conference","a=ssrc-group:SIM 1 2 3","a=ssrc:1 cname:localVideo","a=ssrc:1 msid:"+e.id+" "+t[0].id,"a=ssrc:1 mslabel:"+e.id,"a=ssrc:1 label:"+t[0].id,"a=ssrc:2 cname:localVideo","a=ssrc:2 msid:"+e.id+" "+t[0].id,"a=ssrc:2 mslabel:"+e.id,"a=ssrc:2 label:"+t[0].id,"a=ssrc:3 cname:localVideo","a=ssrc:3 msid:"+e.id+" "+t[0].id,"a=ssrc:3 mslabel:"+e.id,"a=ssrc:3 label:"+t[0].id];return i.push(""),i.join("\n")}function S(e,t,i){if(!(this instanceof S))return new S(e,t,i);S.super_.call(this),t instanceof Function&&(i=t,t=void 0),t=t||{},i=(i||m).bind(this);var r,s=this,a=t.localVideo,g=t.remoteVideo,y=t.videoStream,k=t.audioStream,C=t.mediaConstraints,I=t.peerConnection,T=t.sendSource||"webcam",D=t.dataChannelConfig,O=t.dataChannels||!1,P=o(),_=d({iceServers:n()},t.configuration),U=t.onicecandidate;U&&this.on("icecandidate",U);var R=t.oncandidategatheringdone;R&&this.on("candidategatheringdone",R);var E=t.simulcast,A=t.multistream,x=new l.Interop,V=[],M=!1;if(Object.defineProperties(this,{peerConnection:{get:function(){return I}},id:{value:t.id||P,writable:!1},remoteVideo:{get:function(){return g}},localVideo:{get:function(){return a}},dataChannel:{get:function(){return r}},currentFrame:{get:function(){if(g){if(g.readyState<g.HAVE_CURRENT_DATA)throw new Error("No video stream data available");var e=document.createElement("canvas");return e.width=g.videoWidth,e.height=g.videoHeight,e.getContext("2d").drawImage(g,0,0),e}}}}),!I&&(I=new RTCPeerConnection(_),O&&!r)){var L="WebRtcPeer-"+s.id,j=void 0;D&&(L=D.id||L,j=D.options),r=I.createDataChannel(L,j),D&&(r.onopen=D.onopen,r.onclose=D.onclose,r.onmessage=D.onmessage,r.onbufferedamountlow=D.onbufferedamountlow,r.onerror=D.onerror||m)}!I.getLocalStreams&&I.getSenders&&(I.getLocalStreams=function(){var e=new MediaStream;return I.getSenders().forEach((function(t){e.addTrack(t.track)})),[e]}),!I.getRemoteStreams&&I.getReceivers&&(I.getRemoteStreams=function(){var e=new MediaStream;return I.getReceivers().forEach((function(t){e.addTrack(t.track)})),[e]});!function(e,t){"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?t.onicecandidate=e:t.addEventListener("icecandidate",e)}((function(e){var t,i=e.candidate;c.listenerCount(s,"icecandidate")||c.listenerCount(s,"candidategatheringdone")?i?(t=A&&h?x.candidateToUnifiedPlan(i):i,"undefined"==typeof AdapterJS&&s.emit("icecandidate",t),M=!1):M||("undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?c.prototype.emit("candidategatheringdone",t):s.emit("candidategatheringdone"),M=!0):M||(V.push(i),i||(M=!0))}),I),I.onaddstream=t.onaddstream,I.onnegotiationneeded=t.onnegotiationneeded,this.on("newListener",(function(e,t){if("icecandidate"===e||"candidategatheringdone"===e)for(;V.length;){var i=V.shift();!i==("candidategatheringdone"===e)&&t(i)}}));var q=w(I);function N(){if(console.log("Here is Remote",g,I,I.getRemoteStreams()[0]),g){g.pause();var e=I.getRemoteStreams()[0];g.srcObject=e,u.debug("Remote stream:",e),"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?g=attachMediaStream(g,e):g.load()}}function B(e){var t,i;return E&&("Chrome"===f.name||"Chromium"===f.name?(u.debug("Adding multicast info"),e=new RTCSessionDescription({type:e.type,sdp:(t=e.sdp,i=t.indexOf("a=ssrc-group:FID"),(i>0?t.slice(0,i):t)+b(y))})):u.warn("Simulcast is only available in Chrome browser.")),e}function W(){"closed"===I.signalingState&&i('The peer connection object is in "closed" state. This is most likely due to an invocation of the dispose method before accepting in the dialogue'),y&&a&&s.showLocalVideo(),y&&y.getTracks().forEach((function(e){I.addTrack(e,y)})),k&&k.getTracks().forEach((function(e){I.addTrack(e,k)})),i()}if(this.addIceCandidate=function(e,t){var i;i=A&&h?x.candidateToPlanB(e):new RTCIceCandidate(e),u.debug("Remote ICE candidate received",e),t=(t||m).bind(this),q(i,t)},this.generateOffer=function(t){if(t=t.bind(this),"recvonly"===e){var i=!C||"boolean"!=typeof C.audio||C.audio,n=!C||"boolean"!=typeof C.video||C.video;i&&I.addTransceiver("audio",{direction:"recvonly"}),n&&I.addTransceiver("video",{direction:"recvonly"})}else"sendonly"===e&&I.getTransceivers().forEach((function(e){e.direction="sendonly"}));if("undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9){var r=function(){!function(e){for(var t=(new Date).getTime(),i=0;i<1e7&&!((new Date).getTime()-t>e);i++);}(1e3);var e=I.localDescription;u.debug("Local description set\n",e.sdp),A&&h&&(e=x.toUnifiedPlan(e),u.debug("offer::origPlanB->UnifiedPlan",v(e))),t(null,e.sdp,s.processAnswer.bind(s))};I.createOffer((function(e){u.debug("Created SDP offer"),u.debug("Local description set\n",I.localDescription),I.setLocalDescription(e,r,t)}),t)}else I.createOffer().then((function(e){return u.debug("Created SDP offer"),e=B(e),I.setLocalDescription(e)})).then((function(){var e=I.localDescription;u.debug("Local description set\n",e.sdp),A&&h&&(e=x.toUnifiedPlan(e),u.debug("offer::origPlanB->UnifiedPlan",v(e))),t(null,e.sdp,s.processAnswer.bind(s))})).catch(t)},this.getLocalSessionDescriptor=function(){return I.localDescription},this.getRemoteSessionDescriptor=function(){return I.remoteDescription},this.showLocalVideo=function(){a.srcObject=y,a.muted=!0,"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9&&(a=attachMediaStream(a,y))},this.send=function(e){r&&"open"===r.readyState?r.send(e):u.warn("Trying to send data over a non-existing or closed data channel")},this.processAnswer=function(e,t){t=(t||m).bind(this);var i=new RTCSessionDescription({type:"answer",sdp:e});if(A&&h){var n=x.toPlanB(i);u.debug("asnwer::planB",v(n)),i=n}if(u.debug("SDP answer received, setting remote description"),"closed"===I.signalingState)return t("PeerConnection is closed");I.setRemoteDescription(i).then((function(e){N(),t()}),t)},this.processOffer=function(e,t){t=t.bind(this);var i=new RTCSessionDescription({type:"offer",sdp:e});if(A&&h){var n=x.toPlanB(i);u.debug("offer::planB",v(n)),i=n}if(u.debug("SDP offer received, setting remote description"),"closed"===I.signalingState)return t("PeerConnection is closed");I.setRemoteDescription(i).then((function(){return N()})).then((function(){return I.createAnswer()})).then((function(e){return e=B(e),u.debug("Created SDP answer"),I.setLocalDescription(e)})).then((function(){var e=I.localDescription;A&&h&&(e=x.toUnifiedPlan(e),u.debug("answer::origPlanB->UnifiedPlan",v(e))),u.debug("Local description set\n",e.sdp),t(null,e.sdp)})).catch(t)},"recvonly"===e||y||k)setTimeout(W,0);else{function F(e){void 0===e&&(e=p),"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?navigator.getUserMedia(e,(function(e){y=e,W()}),i):navigator.mediaDevices.getUserMedia(e).then((function(e){y=e,W()})).catch(i)}"webcam"===T?F(C):getScreenConstraints(T,(function(e,t){if(e)return i(e);constraints=[C],constraints.unshift(t),F(d.apply(void 0,constraints))}),P)}this.on("_dispose",(function(){a&&(a.pause(),a.srcObject=null,"undefined"==typeof AdapterJS&&a.load(),a.muted=!1),g&&(g.pause(),g.srcObject=null,"undefined"==typeof AdapterJS&&g.load()),s.removeAllListeners(),"undefined"!=typeof window&&void 0!==window.cancelChooseDesktopMedia&&window.cancelChooseDesktopMedia(P)}))}function k(e){var t="get"+e+"Tracks";return{enumerable:!0,get:function(){if(this.peerConnection){var e=this.peerConnection.getLocalStreams();if(e.length){for(var i,n=0;i=e[n];n++)for(var r,s=i[t](),o=0;r=s[o];o++)if(!r.enabled)return!1;return!0}}},set:function(e){function i(t){t.enabled=e}this.peerConnection.getLocalStreams().forEach((function(e){e[t]().forEach(i)}))}}}function C(e,t){if(!(this instanceof C))return new C(e,t);C.super_.call(this,"recvonly",e,t)}function I(e,t){if(!(this instanceof I))return new I(e,t);I.super_.call(this,"sendonly",e,t)}function T(e,t){if(!(this instanceof T))return new T(e,t);T.super_.call(this,"sendrecv",e,t)}r(S,c),Object.defineProperties(S.prototype,{enabled:{enumerable:!0,get:function(){return this.audioEnabled&&this.videoEnabled},set:function(e){this.audioEnabled=this.videoEnabled=e}},audioEnabled:k("Audio"),videoEnabled:k("Video")}),S.prototype.getLocalStream=function(e){if(this.peerConnection)return this.peerConnection.getLocalStreams()[e||0]},S.prototype.getRemoteStream=function(e){if(this.peerConnection)return this.peerConnection.getRemoteStreams()[e||0]},S.prototype.dispose=function(){u.debug("Disposing WebRtcPeer");var e=this.peerConnection,t=this.dataChannel;try{if(t){if("closed"===t.readyState)return;t.close()}if(e){if("closed"===e.signalingState)return;e.getLocalStreams().forEach(y),e.close()}}catch(e){u.warn("Exception disposing webrtc peer "+e)}"undefined"==typeof AdapterJS&&this.emit("_dispose")},r(C,S),r(I,S),r(T,S),t.bufferizeCandidates=w,t.WebRtcPeerRecvonly=C,t.WebRtcPeerSendonly=I,t.WebRtcPeerSendrecv=T,t.hark=function(e,t){return a(e,t)}},function(e,t,i){"use strict";var n=i(17);e.exports=function(e){var t,r={stun:(e||{}).stun||i(18),turn:(e||{}).turn||i(19)},s=(e||{}).stunCount||2,o=(e||{}).turnCount||0;function a(e,t){for(var i,s=[],o=[].concat(r[e]);o.length&&s.length<t;)i=Math.random()*o.length|0,s=s.concat(o.splice(i,1));return s.map((function(t){return"string"==typeof t||t instanceof String?n(e+":"+t):t}))}return t=[].concat(a("stun",s)),o&&(t=t.concat(a("turn",o))),t}},function(e,t){var i=["stun:","turn:"];e.exports=function(e){var t,n,r=(e||{}).url||e,s={};return"string"==typeof r||r instanceof String?(r=r.trim(),(t=i[i.indexOf(r.slice(0,5))])?(n=(r=r.slice(5)).split("@"),s.username=e.username,s.credential=e.credential,n.length>1&&(r=n[1],n=n[0].split(":"),s.username=n[0],s.credential=(e||{}).credential||n[1]||""),s.url=t+r,s.urls=[s.url],s):e):e}},function(e){e.exports=JSON.parse('["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"]')},function(e){e.exports=JSON.parse("[]")},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},function(e,t,i){var n;!function(r,s){"use strict";var o="model",a="name",c="type",d="vendor",l="version",u="mobile",p="tablet",f="smarttv",h={extend:function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2==0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},m={rgx:function(e,t){for(var i,n,r,s,o,a,c=0;c<t.length&&!o;){var d=t[c],l=t[c+1];for(i=n=0;i<d.length&&!o;)if(o=d[i++].exec(e))for(r=0;r<l.length;r++)a=o[++n],"object"==typeof(s=l[r])&&s.length>0?2==s.length?"function"==typeof s[1]?this[s[0]]=s[1].call(this,a):this[s[0]]=s[1]:3==s.length?"function"!=typeof s[1]||s[1].exec&&s[1].test?this[s[0]]=a?a.replace(s[1],s[2]):void 0:this[s[0]]=a?s[1].call(this,a,s[2]):void 0:4==s.length&&(this[s[0]]=a?s[3].call(this,a.replace(s[1],s[2])):void 0):this[s]=a||void 0;c+=2}},str:function(e,t){for(var i in t)if("object"==typeof t[i]&&t[i].length>0){for(var n=0;n<t[i].length;n++)if(h.has(t[i][n],e))return"?"===i?void 0:i}else if(h.has(t[i],e))return"?"===i?void 0:i;return e}},g={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},y={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[a,l],[/(opios)[\/\s]+([\w\.]+)/i],[[a,"Opera Mini"],l],[/\s(opr)\/([\w\.]+)/i],[[a,"Opera"],l],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[a,l],[/(konqueror)\/([\w\.]+)/i],[[a,"Konqueror"],l],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[a,"IE"],l],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[a,"Edge"],l],[/(yabrowser)\/([\w\.]+)/i],[[a,"Yandex"],l],[/(Avast)\/([\w\.]+)/i],[[a,"Avast Secure Browser"],l],[/(AVG)\/([\w\.]+)/i],[[a,"AVG Secure Browser"],l],[/(puffin)\/([\w\.]+)/i],[[a,"Puffin"],l],[/(focus)\/([\w\.]+)/i],[[a,"Firefox Focus"],l],[/(opt)\/([\w\.]+)/i],[[a,"Opera Touch"],l],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[a,"UCBrowser"],l],[/(comodo_dragon)\/([\w\.]+)/i],[[a,/_/g," "],l],[/(windowswechat qbcore)\/([\w\.]+)/i],[[a,"WeChat(Win) Desktop"],l],[/(micromessenger)\/([\w\.]+)/i],[[a,"WeChat"],l],[/(brave)\/([\w\.]+)/i],[[a,"Brave"],l],[/(qqbrowserlite)\/([\w\.]+)/i],[a,l],[/(QQ)\/([\d\.]+)/i],[a,l],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[a,l],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[a,l],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[a,l],[/(MetaSr)[\/\s]?([\w\.]+)/i],[a],[/(LBBROWSER)/i],[a],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[l,[a,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[l,[a,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[a,l],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[l,[a,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[a,/(.+)/,"$1 WebView"],l],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[a,/(.+(?:g|us))(.+)/,"$1 $2"],l],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[l,[a,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[a,"Sailfish Browser"],l],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[a,l],[/(dolfin)\/([\w\.]+)/i],[[a,"Dolphin"],l],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[a,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[a,"Chrome"],l],[/(coast)\/([\w\.]+)/i],[[a,"Opera Coast"],l],[/fxios\/([\w\.-]+)/i],[l,[a,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[l,[a,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[l,a],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[a,"GSA"],l],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[a,[l,m.str,g.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[a,l],[/(navigator|netscape)\/([\w\.-]+)/i],[[a,"Netscape"],l],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[a,l]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",h.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",h.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",h.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[o,d,[c,p]],[/applecoremedia\/[\w\.]+ \((ipad)/],[o,[d,"Apple"],[c,p]],[/(apple\s{0,1}tv)/i],[[o,"Apple TV"],[d,"Apple"],[c,f]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[d,o,[c,p]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[o,[d,"Amazon"],[c,p]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[o,m.str,g.device.amazon.model],[d,"Amazon"],[c,u]],[/android.+aft([bms])\sbuild/i],[o,[d,"Amazon"],[c,f]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[o,d,[c,u]],[/\((ip[honed|\s\w*]+);/i],[o,[d,"Apple"],[c,u]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[d,o,[c,u]],[/\(bb10;\s(\w+)/i],[o,[d,"BlackBerry"],[c,u]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[o,[d,"Asus"],[c,p]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[d,"Sony"],[o,"Xperia Tablet"],[c,p]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[o,[d,"Sony"],[c,u]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[d,o,[c,"console"]],[/android.+;\s(shield)\sbuild/i],[o,[d,"Nvidia"],[c,"console"]],[/(playstation\s[34portablevi]+)/i],[o,[d,"Sony"],[c,"console"]],[/(sprint\s(\w+))/i],[[d,m.str,g.device.sprint.vendor],[o,m.str,g.device.sprint.model],[c,u]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[d,[o,/_/g," "],[c,u]],[/(nexus\s9)/i],[o,[d,"HTC"],[c,p]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29|ele-l29)/i],[o,[d,"Huawei"],[c,u]],[/android.+(bah2?-a?[lw]\d{2})/i],[o,[d,"Huawei"],[c,p]],[/(microsoft);\s(lumia[\s\w]+)/i],[d,o,[c,u]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[o,[d,"Microsoft"],[c,"console"]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[d,"Microsoft"],[c,u]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[o,[d,"Motorola"],[c,u]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[d,"Motorola"],[c,p]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[d,h.trim],[o,h.trim],[c,f]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[d,"Samsung"],[c,f]],[/\(dtv[\);].+(aquos)/i],[o,[d,"Sharp"],[c,f]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[d,"Samsung"],o,[c,p]],[/smart-tv.+(samsung)/i],[d,[c,f],o],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[d,"Samsung"],o,[c,u]],[/sie-(\w*)/i],[o,[d,"Siemens"],[c,u]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[d,"Nokia"],o,[c,u]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[o,[d,"Acer"],[c,p]],[/android.+([vl]k\-?\d{3})\s+build/i],[o,[d,"LG"],[c,p]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[d,"LG"],o,[c,p]],[/(lg) netcast\.tv/i],[d,o,[c,f]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[o,[d,"LG"],[c,u]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[d,o,[c,p]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[o,[d,"Lenovo"],[c,p]],[/(lenovo)[_\s-]?([\w-]+)/i],[d,o,[c,u]],[/linux;.+((jolla));/i],[d,o,[c,u]],[/((pebble))app\/[\d\.]+\s/i],[d,o,[c,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[d,o,[c,u]],[/crkey/i],[[o,"Chromecast"],[d,"Google"],[c,f]],[/android.+;\s(glass)\s\d/i],[o,[d,"Google"],[c,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[o,[d,"Google"],[c,p]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[o,[d,"Google"],[c,u]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]?[\w\s]+))\s+build/i],[[o,/_/g," "],[d,"Xiaomi"],[c,u]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]?[\w\s]+))\s+build/i],[[o,/_/g," "],[d,"Xiaomi"],[c,p]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[o,[d,"Meizu"],[c,u]],[/(mz)-([\w-]{2,})/i],[[d,"Meizu"],o,[c,u]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[o,[d,"OnePlus"],[c,u]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[o,[d,"RCA"],[c,p]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[o,[d,"Dell"],[c,p]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[o,[d,"Verizon"],[c,p]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[d,"Barnes & Noble"],o,[c,p]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[o,[d,"NuVision"],[c,p]],[/android.+;\s(k88)\sbuild/i],[o,[d,"ZTE"],[c,p]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[o,[d,"Swiss"],[c,u]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[o,[d,"Swiss"],[c,p]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[o,[d,"Zeki"],[c,p]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[d,"Dragon Touch"],o,[c,p]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[o,[d,"Insignia"],[c,p]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[o,[d,"NextBook"],[c,p]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[d,"Voice"],o,[c,u]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[d,"LvTel"],o,[c,u]],[/android.+;\s(PH-1)\s/i],[o,[d,"Essential"],[c,u]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[o,[d,"Envizen"],[c,p]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[d,o,[c,p]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[o,[d,"MachSpeed"],[c,p]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[d,o,[c,p]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[o,[d,"Rotor"],[c,p]],[/android.+(KS(.+))\s+build/i],[o,[d,"Amazon"],[c,p]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[d,o,[c,p]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[c,h.lowerize],d,o],[/[\s\/\(](smart-?tv)[;\)]/i],[[c,f]],[/(android[\w\.\s\-]{0,9});.+build/i],[o,[d,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[l,[a,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[l,[a,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[a,l],[/rv\:([\w\.]{1,9}).+(gecko)/i],[l,a]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[a,l],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[a,[l,m.str,g.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[a,"Windows"],[l,m.str,g.os.windows.version]],[/\((bb)(10);/i],[[a,"BlackBerry"],l],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[a,l],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[a,"Symbian"],l],[/\((series40);/i],[a],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[a,"Firefox OS"],l],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[a,l],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[a,"Chromium OS"],l],[/(sunos)\s?([\w\.\d]*)/i],[[a,"Solaris"],l],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[a,l],[/(haiku)\s(\w+)/i],[a,l],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[l,/_/g,"."],[a,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[a,"Mac OS"],[l,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[a,l]]},v=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof v))return new v(e,t).getResult();var i=e||(r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),n=t?h.extend(y,t):y;return this.getBrowser=function(){var e={name:void 0,version:void 0};return m.rgx.call(e,i,n.browser),e.major=h.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return m.rgx.call(e,i,n.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return m.rgx.call(e,i,n.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return m.rgx.call(e,i,n.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return m.rgx.call(e,i,n.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this};v.VERSION="0.7.22",v.BROWSER={NAME:a,MAJOR:"major",VERSION:l},v.CPU={ARCHITECTURE:"architecture"},v.DEVICE={MODEL:o,VENDOR:d,TYPE:c,CONSOLE:"console",MOBILE:u,SMARTTV:f,TABLET:p,WEARABLE:"wearable",EMBEDDED:"embedded"},v.ENGINE={NAME:a,VERSION:l},v.OS={NAME:a,VERSION:l},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=v),t.UAParser=v):void 0===(n=function(){return v}.call(t,i,t,e))||(e.exports=n);var w=r&&(r.jQuery||r.Zepto);if(w&&!w.ua){var b=new v;w.ua=b.getResult(),w.ua.get=function(){return b.getUA()},w.ua.set=function(e){b.setUA(e);var t=b.getResult();for(var i in t)w.ua[i]=t[i]}}}("object"==typeof window?window:this)},function(e,t,i){var n=i(23),r=i(24);e.exports=function(e,t,i){var s=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[s+a]=o[a];return t||r(o)}},function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);e.exports=function(){return i(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},function(e,t){for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,r=i;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}},function(e,t,i){var n,r=i(26);"undefined"!=typeof window&&(n=window.AudioContext||window.webkitAudioContext);var s=null;e.exports=function(e,t){var i=new r;if(!n)return i;var o,a,c,d=(t=t||{}).smoothing||.1,l=t.interval||50,u=t.threshold,p=t.play,f=t.history||10,h=!0;s=t.audioContext||s||new n,(c=s.createAnalyser()).fftSize=512,c.smoothingTimeConstant=d,a=new Float32Array(c.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(o=s.createMediaElementSource(e),void 0===p&&(p=!0),u=u||-50):(o=s.createMediaStreamSource(e),u=u||-50),o.connect(c),p&&c.connect(s.destination),i.speaking=!1,i.suspend=function(){return s.suspend()},i.resume=function(){return s.resume()},Object.defineProperty(i,"state",{get:function(){return s.state}}),s.onstatechange=function(){i.emit("state_change",s.state)},i.setThreshold=function(e){u=e},i.setInterval=function(e){l=e},i.stop=function(){h=!1,i.emit("volume_change",-100,u),i.speaking&&(i.speaking=!1,i.emit("stopped_speaking")),c.disconnect(),o.disconnect()},i.speakingHistory=[];for(var m=0;m<f;m++)i.speakingHistory.push(0);var g=function(){setTimeout((function(){if(h){var e=function(e,t){var i=-1/0;e.getFloatFrequencyData(t);for(var n=4,r=t.length;n<r;n++)t[n]>i&&t[n]<0&&(i=t[n]);return i}(c,a);i.emit("volume_change",e,u);var t=0;if(e>u&&!i.speaking){for(var n=i.speakingHistory.length-3;n<i.speakingHistory.length;n++)t+=i.speakingHistory[n];t>=2&&(i.speaking=!0,i.emit("speaking"))}else if(e<u&&i.speaking){for(n=0;n<i.speakingHistory.length;n++)t+=i.speakingHistory[n];0==t&&(i.speaking=!1,i.emit("stopped_speaking"))}i.speakingHistory.shift(),i.speakingHistory.push(0+(e>u)),g()}}),l)};return g(),i}},function(e,t){function i(){}e.exports=i,i.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,i){this.callbacks=this.callbacks||{};var n=3===arguments.length,r=n?arguments[1]:void 0,s=n?arguments[2]:arguments[1];return s._groupName=r,(this.callbacks[e]=this.callbacks[e]||[]).push(s),this},t.once=function(e,t,i){var n=this,r=3===arguments.length,s=r?arguments[1]:void 0,o=r?arguments[2]:arguments[1];function a(){n.off(e,a),o.apply(this,arguments)}return this.on(e,s,a),this},t.releaseGroup=function(e){var t,i,n,r;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(i=0,n=(r=this.callbacks[t]).length;i<n;i++)r[i]._groupName===e&&(r.splice(i,1),i--,n--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var i,n=this.callbacks[e];return n?1===arguments.length?(delete this.callbacks[e],this):(-1!==(i=n.indexOf(t))&&(n.splice(i,1),0===n.length&&delete this.callbacks[e]),this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,i,n,r=[].slice.call(arguments,1),s=this.callbacks[e],o=this.getWildcardCallbacks(e);if(s)for(t=0,i=(n=s.slice()).length;t<i&&n[t];++t)n[t].apply(this,r);if(o)for(i=o.length,t=0,i=(n=o.slice()).length;t<i&&n[t];++t)n[t].apply(this,[e].concat(r));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,i,n=[];for(t in this.callbacks)i=t.split("*"),("*"===t||2===i.length&&e.slice(0,i[0].length)===i[0])&&(n=n.concat(this.callbacks[t]));return n}},i.mixin(i)},function(e,t,i){(function(e){!function(t){var i=function(e){return r(!0===e,!1,arguments)};function n(e,t){if("object"!==s(e))return t;for(var i in t)"object"===s(e[i])&&"object"===s(t[i])?e[i]=n(e[i],t[i]):e[i]=t[i];return e}function r(e,t,r){var o=r[0],a=r.length;(e||"object"!==s(o))&&(o={});for(var c=0;c<a;++c){var d=r[c];if("object"===s(d))for(var l in d)if("__proto__"!==l){var u=e?i.clone(d[l]):d[l];o[l]=t?n(o[l],u):u}}return o}function s(e){return{}.toString.call(e).slice(8,-1).toLowerCase()}i.recursive=function(e){return r(!0===e,!0,arguments)},i.clone=function(e){var t,n,r=e,o=s(e);if("array"===o)for(r=[],n=e.length,t=0;t<n;++t)r[t]=i.clone(e[t]);else if("object"===o)for(t in r={},e)r[t]=i.clone(e[t]);return r},t?e.exports=i:window.merge=i}(e&&"object"==typeof e.exports&&e.exports)}).call(this,i(28)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,i){t.Interop=i(30)},function(e,t,i){"use strict";var n=i(31),r=i(35);function s(){this.cache={mlB2UMap:{},mlU2BMap:{}}}e.exports=s,s.prototype.candidateToUnifiedPlan=function(e){var t=new RTCIceCandidate(e);return t.sdpMLineIndex=this.cache.mlB2UMap[t.sdpMLineIndex],t},s.prototype.candidateToPlanB=function(e){var t=new RTCIceCandidate(e);if(0===t.sdpMid.indexOf("audio"))t.sdpMid="audio";else{if(0!==t.sdpMid.indexOf("video"))throw new Error("candidate with "+t.sdpMid+" not allowed");t.sdpMid="video"}return t.sdpMLineIndex=this.cache.mlU2BMap[t.sdpMLineIndex],t},s.prototype.getFirstSendingIndexFromAnswer=function(e){if(!this.cache.answer)return null;var t=n.parse(this.cache.answer);if(t&&t.media&&Array.isArray(t.media))for(var i=0;i<t.media.length;i++)if(t.media[i].type==e&&(!t.media[i].direction||"sendrecv"===t.media[i].direction||"sendonly"===t.media[i].direction))return i;return null},s.prototype.toPlanB=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var i=n.parse(e.sdp);if(void 0===i.media||!Array.isArray(i.media)||0===i.media.length)return console.warn("The description has no media."),e;if(i.media.length<=3&&i.media.every((function(e){return-1!==["video","audio","data"].indexOf(e.mid)})))return console.warn("This description does not look like Unified Plan."),e;for(var r=e.sdp,s=!1,o=0;o<i.media.length;o++){i.media[o].rtp.forEach((function(e){if("NULL"===e.codec){s=!0;var i=n.parse(t.cache.offer);e.codec=i.media[o].rtp[0].codec}}))}s&&(r=n.write(i)),this.cache[e.type]=r;var a=i.media;i.media=[];var c={},d=[];a.forEach((function(e){if(("string"!=typeof e.rtcpMux||"rtcp-mux"!==e.rtcpMux)&&"inactive"!==e.direction)throw new Error("Cannot convert to Plan B because m-lines without the rtcp-mux attribute were found.");if(void 0!==c[e.type]&&"inactive"!==c[e.type].direction||(c[e.type]=e),e.protocol!=c[e.type].protocol)throw new Error("Cannot convert to Plan B because m-lines have different protocols and this library does not have support for that");if(e.payloads!=c[e.type].payloads)throw new Error("Cannot convert to Plan B because m-lines have different payloads and this library does not have support for that")})),a.forEach((function(e){if("application"===e.type)return i.media.push(e),void d.push(e.mid);"object"==typeof e.sources&&Object.keys(e.sources).forEach((function(t){"object"!=typeof c[e.type].sources&&(c[e.type].sources={}),c[e.type].sources[t]=e.sources[t],void 0!==e.msid&&(c[e.type].sources[t].msid=e.msid)})),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&(void 0!==c[e.type].ssrcGroups&&Array.isArray(c[e.type].ssrcGroups)||(c[e.type].ssrcGroups=[]),c[e.type].ssrcGroups=c[e.type].ssrcGroups.concat(e.ssrcGroups)),c[e.type]===e&&(e.mid=e.type,delete e.bundleOnly,delete e.msid,e.type==a[0].type?(d.unshift(e.type),i.media.unshift(e)):(d.push(e.type),i.media.push(e)))})),void 0!==i.groups&&i.groups.some((function(e){if("BUNDLE"===e.type)return e.mids=d.join(" "),!0})),i.msidSemantic={semantic:"WMS",token:"*"};var l=n.write(i);return new RTCSessionDescription({type:e.type,sdp:l})},s.prototype.toUnifiedPlan=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var i=n.parse(e.sdp);if(void 0===i.media||!Array.isArray(i.media)||0===i.media.length)return console.warn("The description has no media."),e;if(i.media.length>3||!i.media.every((function(e){return-1!==["video","audio","data"].indexOf(e.mid)})))return console.warn("This description does not look like Plan B."),e;var s=[];i.media.forEach((function(e){s.push(e.mid)}));var o,a,c=!1;if(void 0!==i.groups&&Array.isArray(i.groups)&&(c=i.groups.every((function(e){return"BUNDLE"!==e.type||r.apply(e.mids.sort(),[s.sort()])}))),!c){var d=!1;if(i.media.forEach((function(e){"inactive"!==e.direction&&(d=!0)})),d)throw new Error("Cannot convert to Unified Plan because m-lines that are not bundled were found.")}if("answer"===e.type)o="offer";else{if("offer"!==e.type)throw new Error("Type '"+e.type+"' not supported.");o="answer"}void 0!==this.cache[o]&&(a=n.parse(this.cache[o]));var l,u,p,f,h={audio:{},video:{}},m={},g=0,y=0,v={},w={},b={},S={};if(i.media.forEach((function(i){if(("string"!=typeof i.rtcpMux||"rtcp-mux"!==i.rtcpMux)&&"inactive"!==i.direction)throw new Error("Cannot convert to Unified Plan because m-lines without the rtcp-mux attribute were found.");if("application"!==i.type){var n=i.sources,r=i.ssrcGroups,s=i.port;if(void 0!==i.candidates&&(l=void 0!==l?l.concat(i.candidates):i.candidates),void 0!==u&&void 0!==i.iceUfrag&&u!=i.iceUfrag)throw new Error("Only BUNDLE supported, iceUfrag must be the same for all m-lines.\n\tLast iceUfrag: "+u+"\n\tNew iceUfrag: "+i.iceUfrag);if(void 0!==i.iceUfrag&&(u=i.iceUfrag),void 0!==p&&void 0!==i.icePwd&&p!=i.icePwd)throw new Error("Only BUNDLE supported, icePwd must be the same for all m-lines.\n\tLast icePwd: "+p+"\n\tNew icePwd: "+i.icePwd);if(void 0!==i.icePwd&&(p=i.icePwd),void 0!==f&&void 0!==i.fingerprint&&(f.type!=i.fingerprint.type||f.hash!=i.fingerprint.hash))throw new Error("Only BUNDLE supported, fingerprint must be the same for all m-lines.\n\tLast fingerprint: "+JSON.stringify(f)+"\n\tNew fingerprint: "+JSON.stringify(i.fingerprint));void 0!==i.fingerprint&&(f=i.fingerprint),w[i.type]=i.payloads,b[i.type]=i.rtcpFb,S[i.type]=i.rtp;var o={};void 0!==r&&Array.isArray(r)&&r.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&e.ssrcs.forEach((function(t){void 0===o[t]&&(o[t]=[]),o[t].push(e)}))}));var c={};if("object"==typeof n)delete i.sources,delete i.ssrcGroups,delete i.candidates,delete i.iceUfrag,delete i.icePwd,delete i.fingerprint,delete i.port,delete i.mid,Object.keys(n).forEach((function(r){var d;"offer"!==e.type||n[r].msid?(void 0!==o[r]&&Array.isArray(o[r])&&o[r].some((function(e){return e.ssrcs.some((function(e){if("object"==typeof c[e])return d=c[e],!0}))})),"object"==typeof d?(d.sources[r]=n[r],delete n[r].msid):(d=Object.create(i),c[r]=d,void 0!==n[r].msid&&(d.msid=n[r].msid,delete n[r].msid),d.sources={},d.sources[r]=n[r],d.ssrcGroups=o[r],void 0!==a&&void 0!==a.media&&Array.isArray(a.media)&&a.media.forEach((function(e){"object"==typeof e.sources&&Object.keys(e.sources).forEach((function(t){t===r&&(d.mid=e.mid)}))})),void 0===d.mid&&(d.mid=[i.type,"-",r].join("")),d.candidates=l,d.iceUfrag=u,d.icePwd=p,d.fingerprint=f,d.port=s,m[d.mid]=d,v[y]=d.sources,t.cache.mlU2BMap[y]=g,void 0===t.cache.mlB2UMap[g]&&(t.cache.mlB2UMap[g]=y),y++)):h[i.type][r]=n[r]}));else{var d=i;d.candidates=l,d.iceUfrag=u,d.icePwd=p,d.fingerprint=f,d.port=s,m[d.mid]=d,t.cache.mlU2BMap[y]=g,void 0===t.cache.mlB2UMap[g]&&(t.cache.mlB2UMap[g]=y)}g++}else m[i.mid]=i})),i.media=[],s=[],"answer"===e.type)for(var k=0;k<a.media.length;k++){var C=a.media[k];delete C.msid,delete C.sources,delete C.ssrcGroups,void 0===v[k]?C.direction&&"sendrecv"!==C.direction?"sendonly"===C.direction&&(C.direction="inactive"):C.direction="recvonly":C.direction&&"sendrecv"!==C.direction?"recvonly"===C.direction&&(C.direction="sendonly"):C.direction="sendrecv",C.sources=v[k],C.candidates=l,C.iceUfrag=u,C.icePwd=p,C.fingerprint=f,C.rtp=S[C.type],C.payloads=w[C.type],C.rtcpFb=b[C.type],i.media.push(C),"string"==typeof C.mid&&s.push(C.mid)}else void 0!==a&&void 0!==a.media&&Array.isArray(a.media)&&a.media.forEach((function(e){s.push(e.mid),void 0!==m[e.mid]?i.media.push(m[e.mid]):(delete e.msid,delete e.sources,delete e.ssrcGroups,e.direction&&"sendrecv"!==e.direction||(e.direction="sendonly"),e.direction&&"recvonly"!==e.direction||(e.direction="inactive"),function(e){void 0!==e.setup&&("active"===e.setup?e.setup="passive":"passive"===e.setup&&(e.setup="active"))}(e),i.media.push(e))})),Object.keys(m).forEach((function(e){if(-1===s.indexOf(e))if(s.push(e),"recvonly"===m[e].direction){var t=!1;i.media.some((function(i){if(("sendrecv"===i.direction||"sendonly"===i.direction)&&i.type===m[e].type)return Object.keys(m[e].sources).forEach((function(t){i.sources[t]=m[e].sources[t]})),t=!0,!0})),t||i.media.push(m[e])}else i.media.push(m[e])}));["audio","video"].forEach((function(e){if(i&&i.media&&Array.isArray(i.media)){var n=null;if(Object.keys(h[e]).length>0&&null===(n=t.getFirstSendingIndexFromAnswer(e)))for(var r=0;r<i.media.length;r++)if(i.media[r].type===e){n=r;break}if(n&&i.media.length>n){var s=i.media[n];Object.keys(h[e]).forEach((function(t){s.sources&&s.sources[t]&&console.warn("Replacing an existing SSRC."),s.sources||(s.sources={}),s.sources[t]=h[e][t]}))}}})),void 0!==i.groups&&i.groups.some((function(e){if("BUNDLE"===e.type)return e.mids=s.join(" "),!0})),i.msidSemantic={semantic:"WMS",token:"*"};var I=n.write(i);return this.cache[e.type]=I,new RTCSessionDescription({type:e.type,sdp:I})}},function(e,t,i){var n=i(32);t.write=function(e,t){return void 0!==e&&void 0!==e.media&&Array.isArray(e.media)&&e.media.forEach((function(e){void 0!==e.sources&&0!==Object.keys(e.sources).length&&(e.ssrcs=[],Object.keys(e.sources).forEach((function(t){var i=e.sources[t];Object.keys(i).forEach((function(n){e.ssrcs.push({id:t,attribute:n,value:i[n]})}))})),delete e.sources),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.ssrcs=e.ssrcs.join(" "))}))})),void 0!==e&&void 0!==e.groups&&Array.isArray(e.groups)&&e.groups.forEach((function(e){void 0!==e.mids&&Array.isArray(e.mids)&&(e.mids=e.mids.join(" "))})),n.write(e,t)},t.parse=function(e){var t=n.parse(e);return void 0!==t&&void 0!==t.media&&Array.isArray(t.media)&&t.media.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.sources={},e.ssrcs.forEach((function(t){e.sources[t.id]||(e.sources[t.id]={}),e.sources[t.id][t.attribute]=t.value})),delete e.ssrcs),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach((function(e){"string"==typeof e.ssrcs&&(e.ssrcs=e.ssrcs.split(" "))}))})),void 0!==t&&void 0!==t.groups&&Array.isArray(t.groups)&&t.groups.forEach((function(e){"string"==typeof e.mids&&(e.mids=e.mids.split(" "))})),t}},function(e,t,i){var n=i(33),r=i(34);t.write=r,t.parse=n.parse,t.parseFmtpConfig=n.parseFmtpConfig,t.parsePayloads=n.parsePayloads,t.parseRemoteCandidates=n.parseRemoteCandidates},function(e,t,i){var n=function(e){return String(Number(e))===e?Number(e):e},r=function(e,t,i){var r=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:r&&!t[e.name]&&(t[e.name]={});var s=e.push?{}:r?t[e.name]:t;!function(e,t,i,r){if(r&&!i)t[r]=n(e[1]);else for(var s=0;s<i.length;s+=1)null!=e[s+1]&&(t[i[s]]=n(e[s+1]))}(i.match(e.reg),s,e.names,e.name),e.push&&t[e.push].push(s)},s=i(8),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},i=[],n=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach((function(e){var t=e[0],o=e.slice(2);"m"===t&&(i.push({rtp:[],fmtp:[]}),n=i[i.length-1]);for(var a=0;a<(s[t]||[]).length;a+=1){var c=s[t][a];if(c.reg.test(o))return r(c,n,o)}})),t.media=i,t};var a=function(e,t){var i=t.split("=");return 2===i.length&&(e[i[0]]=n(i[1])),e};t.parseFmtpConfig=function(e){return e.split(/\;\s?/).reduce(a,{})},t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],i=e.split(" ").map(n),r=0;r<i.length;r+=3)t.push({component:i[r],ip:i[r+1],port:i[r+2]});return t}},function(e,t,i){var n=i(8),r=/%[sdv%]/g,s=function(e){var t=1,i=arguments,n=i.length;return e.replace(r,(function(e){if(t>=n)return e;var r=i[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(r);case"%d":return Number(r);case"%v":return""}}))},o=function(e,t,i){var n=[e+"="+(t.format instanceof Function?t.format(t.push?i:i[t.name]):t.format)];if(t.names)for(var r=0;r<t.names.length;r+=1){var o=t.names[r];t.name?n.push(i[t.name][o]):n.push(i[t.names[r]])}else n.push(i[t.name]);return s.apply(null,n)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var i=t.outerOrder||a,r=t.innerOrder||c,s=[];return i.forEach((function(t){n[t].forEach((function(i){i.name in e&&null!=e[i.name]?s.push(o(t,i,e)):i.push in e&&null!=e[i.push]&&e[i.push].forEach((function(e){s.push(o(t,i,e))}))}))})),e.media.forEach((function(e){s.push(o("m",n.m[0],e)),r.forEach((function(t){n[t].forEach((function(i){i.name in e&&null!=e[i.name]?s.push(o(t,i,e)):i.push in e&&null!=e[i.push]&&e[i.push].forEach((function(e){s.push(o(t,i,e))}))}))}))})),s.join("\r\n")+"\r\n"}},function(e,t){e.exports=function e(t){if(!t)return!1;if(this.length!=t.length)return!1;for(var i=0,n=this.length;i<n;i++)if(this[i]instanceof Array&&t[i]instanceof Array){if(!e.apply(this[i],[t[i]]))return!1}else if(this[i]!=t[i])return!1;return!0}},function(e,t){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(2),s=i(1),o=i(3);class a extends n.EventEmitter{constructor(e){super(),this.participants={},this.videoArray=[],this.call_type="video",this.projectID=e.projectId,this.projectSecret=e.secret,this.currentUser=e.currentUser,this.currentRoom=e.room,this.localVideo=e.localVideo,this.container=e.container,this.call_type=e.call_type,this.Authentication(e)}Authentication(e){this.Connect(e.media_server)}Connect(e){var t=new WebSocket(e);t.onmessage=e=>{var t=JSON.parse(e.data);switch(console.log("Received message: "+e.data),t.id){case"existingParticipants":console.log("===yes you====",t),this.OnExistingParticipant(t);break;case"newParticipantArrived":this.onNewParticipant(t);break;case"participantLeft":this.OnParticipantLeft(t);break;case"receiveVideoAnswer":this.ReceiveVideoResponse(t);break;case"iceCandidate":this.participants[t.name].addIceCandidate(t.candidate,(function(e){e&&console.error("Error adding candidate: "+e)}));break;default:console.error("Unrecognized message",t)}},t.onclose=e=>{r.default.OnDisconnection(e,this),console.log("OnClose socket==",e)},t.onopen=e=>{this.Register(),r.default.OnConnection(e,this),console.log("OnOpen socket==",e)},t.onerror=e=>{r.default.OnDisconnection(e,this),console.log("OnError socket==",e)},this.ws=t}OnExistingParticipant(e){let t={mandatory:{maxWidth:320,maxFrameRate:15,minFrameRate:15}};"video"!=this.call_type&&(t=!1);var i={audio:!0,video:t};s.SetPlaysInline(this.localVideo);var n={localVideo:this.localVideo,mediaConstraints:i,onicecandidate:e=>{var t={id:"onIceCandidate",candidate:e,name:this.currentUser};this.SendPacket(t)}};let r=new o.WebRtcPeer.WebRtcPeerSendonly(n,e=>{if(e)return console.error(e);r.generateOffer((e,t,i)=>{if(e)return console.error("sdp offer error");var n={id:"receiveVideoFrom",sender:this.currentUser,sdpOffer:t};this.SendPacket(n)})});this.participants[this.currentUser]=r,e.data.forEach(e=>{this.emit("groupCall",{type:"NEW_PARTICIPANT",message:"Participant List",participant:e})})}SetParticipantVideo(e,t){s.SetPlaysInline(e);var i={remoteVideo:e,onicecandidate:e=>{var i={id:"onIceCandidate",candidate:e,name:t};this.SendPacket(i)}};let n=new o.WebRtcPeer.WebRtcPeerRecvonly(i,e=>{if(e)return console.error(e);n.generateOffer((e,i)=>{if(e)return console.error("sdp offer error");console.log("Invoking SDP offer callback function");var n={id:"receiveVideoFrom",sender:t,sdpOffer:i};this.SendPacket(n)})});this.participants[t]=n}onNewParticipant(e){this.emit("groupCall",{type:"NEW_PARTICIPANT",message:"Participant has joined",participant:e.name})}OnParticipantLeft(e){this.emit("groupCall",{type:"PARTICIPANT_LEFT",message:"Participant has left",participant:e.name});var t=this.participants[e.name];t&&null!=t&&(t.dispose(),delete this.participants[e.name])}ReceiveVideoResponse(e){let t=this.participants[e.name];console.log("===ongroupcall==recievresp==",e,"participant",this.participants),t&&null!=t&&t.processAnswer(e.sdpAnswer,(function(e){if(e)return console.error(e)}))}OnIceCandidate(e){let t=this.participants[e.name];null!=t&&t.addIceCandidate(e.candidate,(function(e){e&&console.error("Error adding candidate: "+e)}))}LeaveRoom(){for(var e in this.SendPacket({id:"leaveRoom"}),this.participants){let t=this.participants[e];t&&null!=t&&t.dispose()}this.ws.close()}Close(){}Register(){var e={id:"joinRoom",name:this.currentUser,room:this.currentRoom};this.SendPacket(e)}SendPacket(e){var t=JSON.stringify(e);console.log("Sending message: "+t),null!=this.ws?this.ws.send(t):r.default.OnAuthInitialError("",this)}SetMicMute(){let e=this.participants[this.currentUser].getVideoElement();e&&null!=e&&(e.srcObject.getAudioTracks()[0].enabled=!1)}SetMicUnmute(){let e=this.participants[this.currentUser].getVideoElement();e&&null!=e&&(e.srcObject.getAudioTracks()[0].enabled=!0)}SetCameraOn(){let e=this.participants[this.currentUser].getVideoElement();e&&null!=e&&(e.srcObject.getVideoTracks()[0].enabled=!0)}SetCameraOff(){let e=this.participants[this.currentUser].getVideoElement();e&&null!=e&&(e.srcObject.getVideoTracks()[0].enabled=!1)}GetContainer(){let e=document.createElement("section");for(var t in this.participants){let i=this.participants[t].getVideoElement(),n=this.participants[t].createVideo(i.srcObject);e.appendChild(n)}return e}}t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(2),s=i(4),o=i(5),a=i(6),c=i(7),d=i(1),l=i(3);class u extends n.EventEmitter{constructor(e){super(),this.UUIDSessions={},this.UUIDSessionTypes={},this.UUIDSessionMediaTypes={},this.participants={},this.participantVideo={},this.callSession="",this.participatArray=[],this.projectID=e.projectID,this.projectSecret=e.secret,this.Authentication(e)}set McToken(e){this.mcToken=e}get McToken(){return this.mcToken}Authentication(e){console.log("====DER===",e,this.projectID,this.projectSecret,this.clientToken),s.default.Authorization(e.projectID,e.secret).then(e=>{if(console.log("===Authorization-outer===",e),e&&200==e.status){let t=`${e.media_server_map.protocol}://${e.media_server_map.host}:${e.media_server_map.port}/${e.media_server_map.end_point}`;this.Connect(t),console.log("===Authorization===",e)}else r.default.OnAuthError(e.message,this)})}Connect(e){var t=new WebSocket(e);t.onmessage=e=>{var t=JSON.parse(e.data);switch(console.log("Received message: ",t),t.requestType){case"register":a.default.SetRegisterResponse(t,this);break;case"callResponse":console.log(" CallResponse: ",t),this.CallResponse(t);break;case"incomingCall":this.callSession=t.sessionUUID,console.log("incomingCall case: ",e),r.default.OnIncomingGroupCall(t,this);break;case"startCommunication":this.SessionStart(t);break;case"stopCommunication":console.info("Communication ended by remote peer",t);break;case"iceCandidate":this.AddCandidate(t);break;case"session_invite":break;case"session_cancel":this.OnSessionCancel(t),console.log("===onParticipantOffer== exiting session_cancel",t,(new Date).toLocaleTimeString());break;case"existing_participants":console.log("===onParticipantOffer== exiting",t,(new Date).toLocaleTimeString()),this.OnExistingParticipants(t);break;case"new_participant_arrived":console.log("===onParticipantOffer== exiting new",t,(new Date).toLocaleTimeString()),this.OnNewParticipant(t);break;case"participantLeft":console.log("===onParticipantOffer== exiting left",t,(new Date).toLocaleTimeString()),this.OnParticipantLeft(t);break;case"state_information":console.log("===onParticipantOffer== exiting left",t,(new Date).toLocaleTimeString()),r.default.SetParticipantStatus(t,this)}},t.onclose=e=>{r.default.OnDisconnection(e,this),console.log("OnClose socket==",e)},t.onopen=e=>{r.default.OnConnection(e,this),console.log("OnOpen socket==",e)},t.onerror=e=>{r.default.OnDisconnection(e,this),console.log("OnError socket==",e)},this.ws=t}AddCandidate(e){console.log("Add Ice Candidate::::",e,this.participants[e.referenceID]),this.participants[e.referenceID].addIceCandidate(e.candidate,e=>{if(e)return r.default.OnAddCandidate(e,this),console.error("Error adding candidate: "+e)})}OnExistingParticipants(e){let t=e.referenceIDs;t.forEach(e=>{null!=e&&this.emit("groupCall",{type:"NEW_PARTICIPANT",message:"New participant arrived.",participant:e})})}OnSessionCancel(e){let t=e.referenceID;this.emit("groupCall",{type:"PARTICIPANT_LEFT",message:"Participant left.",participant:t});var i=this.participants[t];this.participatArray.splice(this.participatArray.indexOf(t),1),i&&null!=i&&i.dispose(),delete this.participants[t],delete this.participantVideo[t]}OnNewParticipant(e){let t=e.referenceID;null!=t&&-1==this.participatArray.indexOf(t)&&this.emit("groupCall",{type:"NEW_PARTICIPANT",message:"New participant arrived.",participant:t})}OnParticipantLeft(e){let t=e.referenceID;this.emit("groupCall",{type:"PARTICIPANT_LEFT",message:"Participant left.",participant:t})}SetParticipantVideo(e,t){d.SetPlaysInline(t);let i={remoteVideo:t,onicecandidate:t=>{this.OnParticipantIceCandidate(t,e)},onerror:this.onError},n=new l.WebRtcPeer.WebRtcPeerRecvonly(i,t=>{if(t)return console.error(t);n.generateOffer((t,i)=>{this.onParticipantOffer(t,i,e)})});return this.participants[e]=n,this.participantVideo[e]=t,t}ExistingParticipant(e){var t;let i=document.createElement("video");i.autoplay=!0,i.muted=!0,i.style.display="none";let n={remoteVideo:i,onicecandidate:t=>{this.OnParticipantIceCandidate(t,e)},onerror:this.onError},r=new l.WebRtcPeer.WebRtcPeerRecvonly(n,t=>{if(t)return console.error(t);r.generateOffer((t,i)=>{this.onParticipantOffer(t,i,e)})});return this.participants[e]=r,this.participantVideo[e]=i,null===(t=document.getElementById("hellofyou"))||void 0===t||t.appendChild(i),i}CallResponse(e){console.info("CallResponse",this.participants[e.referenceID],e),"accepted"==e.response&&this.participants[e.referenceID].processAnswer(e.sdpAnswer,e=>{if(e)return r.default.SessionSDP(e,this),console.error(e)})}SessionStart(e){r.default.SessionStart(e,this),console.log("Start=Commm",e.referenceID,e.referenceID,this.participants[e.referenceID]),this.participants[e.referenceID].processAnswer(e.sdpAnswer,e=>{if(e)return r.default.SessionSDP(e,this),console.error(e)})}onOfferIncomingCall(e,t,i){if(e)return r.default.OnOfferIncomingCall(e,this),console.error("Error generating the offer");let n={type:"request",requestType:"session_invite",sdpOffer:t,requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,referenceID:this.currentUser,responseCode:200,responseMessage:"accepted"};console.log("===OnOffering Answer",n),this.SendPacket(n)}OnOfferManytoManyCall(e,t,i){if(e)return r.default.OnOfferIncomingCall(e,this),console.error("Error generating the offer");let n={type:"request",requestType:"session_invite",sdpOffer:t,requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,referenceID:this.currentUser,responseCode:200,responseMessage:"accepted"};console.log("===OnOffering Answer",n),this.SendPacket(n)}Register(e,t){this.currentUser=e;let i=new o.default;i.requestID=(new Date).getTime().toString(),i.tenantID=this.projectID,i.referenceID=e,i.authorizationToken=t,i.SendRegisterRequest(this.ws)}GroupCall(e){this.to=Array.isArray(e.to)?e.to:[e.to],this.currentFromUser=this.currentUser,this.localVideo=e.localVideo,d.SetPlaysInline(this.localVideo);var t={mediaConstraints:{audio:!0,video:"audio"!=e.call_type},localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};let i=new l.WebRtcPeer.WebRtcPeerSendonly(t,t=>{if(t)return console.error(t);i.generateOffer((t,i)=>{this.onManyToManyOfferCall(t,i,e.call_type)})});this.participants[this.currentUser]=i}JoinGroupCall(e){this.localVideo=e.localVideo,d.SetPlaysInline(this.localVideo);var t={mediaConstraints:{audio:!0,video:"audio"!=e.call_type},localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentFromUser)},onerror:this.onError};let i=new l.WebRtcPeer.WebRtcPeerSendonly(t,t=>{if(t)return console.error(t);i.generateOffer((t,i)=>{console.log("======here===it goes inner sess",this.callSession),this.onJoinManyToManyOfferCall(t,i,e.call_type)}),console.log("======here===it goes")});this.participants[this.currentUser]=i}Broadcasting(e){this.to=e.to,this.currentFromUser=this.currentUser,this.localVideo=e.localVideo;var t={localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new l.WebRtcPeer.WebRtcPeerSendonly(t,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferOneToManyCall(e,t)})})}onOfferOneToManyCall(e,t){if(e)return r.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let i=(new Date).getTime().toString();this.UUIDSessions[this.currentUser]=i,this.UUIDSessionTypes[i]="one_to_many";let n=new c.default;n.from=this.currentUser,n.to=this.to,n.requestID=i,n.sessionUUID=i,n.mcToken=this.McToken,n.sdpOffer=t,n.call_type="one_to_many",n.SendCallRequest(this.ws)}AcceptBroadcast(e){let t=this.currentFromUser;var i={remoteVideo:e,onicecandidate:e=>{this.onIceCandidate(e,t)},onerror:this.onError};this.webRtcPeer=new l.WebRtcPeer.WebRtcPeerRecvonly(i,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,i)=>{this.onOfferIncomingCall(e,i,t)})})}onOfferCall(e,t,i){if(e)return r.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let n=(new Date).getTime().toString(),s=new c.default;s.from=this.currentUser,s.to=this.to,s.requestID=n,s.sessionUUID=n,s.mcToken=this.McToken,s.sdpOffer=t,s.media_type=i,s.SendCallRequest(this.ws),this.UUIDSessions[this.currentUser]=n,this.UUIDSessionTypes[n]="one_to_one",console.log(" OnOfferCall :: :: ::",i)}onManyToManyOfferCall(e,t,i){if(e)return r.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let n=(new Date).getTime().toString();this.callSession=n;let s=new c.default;s.from=this.currentUser,s.to=this.to,s.requestID=n,s.sessionUUID=n,s.mcToken=this.McToken,s.sdpOffer=t,s.media_type=i,s.call_type="many_to_many",s.SendCallRequest(this.ws),console.log(" OnOfferCall :: :: ::",i)}onJoinManyToManyOfferCall(e,t,i){if(e)return r.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);console.log("======here===it goes inner",i);let n=(new Date).getTime().toString(),s=this.callSession;console.log("======here===it goes sess",s);var o={from:this.currentUser,sdpOffer:t,responseCode:200,responseMessage:"accepted",requestType:"session_invite",type:"request",session_type:"call",call_type:"many_to_many",media_type:i,requestID:n,sessionUUID:this.callSession,mcToken:this.mcToken};this.SendPacket(o)}onParticipantOffer(e,t,i){if(e)return r.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let n=(new Date).getTime().toString();var s={from:this.currentUser,to:i,requestType:"to_receive_stream",sdpOffer:t,requestID:n,type:"request",sessionUUID:this.callSession,mcToken:this.McToken};console.log("===onParticipantOffer==",s),this.SendPacket(s)}DisposeWebrtc(e){for(var t in this.participants){let e=this.participants[t];e&&null!=e&&e.dispose()}this.participants={},this.participantVideo={},this.callSession="",this.participatArray=[]}onError(e){r.default.OnRTCPeer(e,this)}onIceCandidate(e,t){console.log("Local candidate"+JSON.stringify(e));var i={requestType:"onIceCandidate",candidate:e,referenceID:t,sessionUUID:this.callSession};this.SendPacket(i)}SendPacket(e){var t=JSON.stringify(e);console.log("Sending message: "+t),null!=this.ws?this.ws.send(t):r.default.OnAuthInitialError("",this)}OnParticipantIceCandidate(e,t){var i={requestType:"onIceCandidate",candidate:e,referenceID:t,sessionUUID:this.callSession};this.SendPacket(i)}SetMicMute(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:0,videoInformation:1};this.SendPacket(e),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!1),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!1)}}SetMicUnmute(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:1};this.SendPacket(e),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!0),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!0)}}SetCameraOn(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:1};this.SendPacket(e),this.localVideo.srcObject.getVideoTracks()[0].enabled=!0}}SetCameraOff(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:0};this.SendPacket(e),this.localVideo.srcObject.getVideoTracks()[0].enabled=!1}}LeaveGroupCall(){let e={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken};this.SendPacket(e),this.DisposeWebrtc(!1)}CancelCall(){let e=this.currentFromUser,t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[e],mcToken:this.McToken};this.SendPacket(t),this.DisposeWebrtc(!1)}}t.default=u}])}));