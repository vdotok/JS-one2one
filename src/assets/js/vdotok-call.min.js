!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CVDOTOK=t():e.CVDOTOK=t()}(this,(function(){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=9)}([function(e,t,i){"use strict";var s,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};s=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(i,s){function n(){void 0!==r&&e.removeListener("error",r),i([].slice.call(arguments))}var r;"error"!==t&&(r=function(i){e.removeListener(t,n),s(i)},e.once("error",r)),e.once(t,n)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,i,s){var n,r,o,a;if(l(i),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),r=e._events),o=r[t]),void 0===o)o=r[t]=i,++e._eventsCount;else if("function"==typeof o?o=r[t]=s?[i,o]:[o,i]:s?o.unshift(i):o.push(i),(n=d(e))>0&&o.length>n&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,a=c,console&&console.warn&&console.warn(a)}return e}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,i){var s={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},n=p.bind(s);return n.listener=i,s.wrapFn=n,n}function f(e,t,i){var s=e._events;if(void 0===s)return[];var n=s[t];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(n):g(n,n.length)}function m(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function g(e,t){for(var i=new Array(t),s=0;s<t;++s)i[s]=e[s];return i}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return d(this)},a.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var s="error"===e,n=this._events;if(void 0!==n)s=s&&void 0===n.error;else if(!s)return!1;if(s){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=n[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var l=c.length,d=g(c,l);for(i=0;i<l;++i)r(d[i],this,t)}return!0},a.prototype.addListener=function(e,t){return u(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return u(this,e,t,!0)},a.prototype.once=function(e,t){return l(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var i,s,n,r,o;if(l(t),void 0===(s=this._events))return this;if(void 0===(i=s[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(n=-1,r=i.length-1;r>=0;r--)if(i[r]===t||i[r].listener===t){o=i[r].listener,n=r;break}if(n<0)return this;0===n?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,n),1===i.length&&(s[e]=i[0]),void 0!==s.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,i,s;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var n,r=Object.keys(i);for(s=0;s<r.length;++s)"removeListener"!==(n=r[s])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]}},function(e,t,i){"use strict";function s(e){return e instanceof Element}Object.defineProperty(t,"__esModule",{value:!0}),t.UuidGenerator=t.SetPlaysInline=t.IsDOM=t.GetKeyByValue=void 0,t.GetKeyByValue=function(e,t){return Object.keys(e).find(i=>e[i]===t)},t.IsDOM=s,t.SetPlaysInline=function(e){s(e)&&e.setAttribute("playsinline",!0)},t.UuidGenerator=function(){var e=String.fromCharCode(Math.floor(25*Math.random()+65));do{var t=Math.floor(42*Math.random()+48);(t<58||t>64)&&(e+=String.fromCharCode(t))}while(e.length<32);return e}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(1);const n=new class{constructor(){}OnAuthError(e,t){t.emit("error",{type:"Authorization",message:"Your credentials for vidtok are invalid."+e})}OnAuthInitialError(e,t){t.emit("error",{type:"Authorization",message:"You are not connected with vidtok server."+e})}OnConnection(e,t){t.emit("connected",{type:"Success",message:"Vidtok server is connected successfully"})}OnDisconnection(e,t){t.emit("disconnected",{type:"Error",message:"Vidtok server is disconnected."+e})}OnRegister(e,t){let i=e.response;if("accepted"==i.trim())t.emit("register",{type:"REGISTER_ACCEPTED",message:"User is registered successfully"});else{let e=i.split(":")[1];e=e.trim(),t.emit("error",{type:"REGISTER_REJECTED",message:e})}}OnCallResponse(e,t){let i=e.response,s=e.from;if("accepted"==i){let i={type:"CALL_ACCEPTED",message:"Call is accepted by receiver",from:s,call_type:"one_to_one"};e.call_type&&(i.call_type=e.call_type),t.emit("call",i)}else{let i={type:"CALL_REJECTED",message:"Call is rejected by receiver",from:s,call_type:"one_to_one"};e.call_type&&(i.call_type=e.call_type),t.emit("call",i),t.DisposeWebrtc(!0)}}OnIncomingCall(e,t){let i=e.from,s=null!=e.call_type?e.call_type:"one_to_one";"many_to_many"==s?t.emit("groupCall",{type:"CALL_RECEIVED",message:"Received a call",from:i,call_type:e.media_type,session:s}):t.emit("call",{type:"CALL_RECEIVED",message:"Received a call",from:i,call_type:e.media_type,session:s})}OnIncomingGroupCall(e,t){let i=e.from,s=e.call_type;t.emit("groupCall",{type:"CALL_RECEIVED",message:"Received a call",from:i,call_type:e.media_type,session:s})}SessionStart(e,t){t.emit("call",{type:"CALL_STARTED",message:"Call is being started"})}GroupSessionStart(e,t){t.emit("groupCall",{type:"CALL_STARTED",message:"Call is being started"})}SessionSDP(e,t){t.emit("error",{type:"PROCESS_ANSWER",message:"Unable to process remote SDP."})}OnAddCandidate(e,t){t.emit("error",{type:"CALL_ADDCANDIDATE",message:"Unable to add ice candidate."})}OnOfferIncomingCall(e,t){t.emit("error",{type:"CALL_OFFERGENERATING",message:"Unable to add generate incoming call offer."})}OnRTCPeer(e,t){t.emit("error",{type:"CALL_RTCPEER",message:"Unable to add to create webrtc peer."+e})}SessionEnd(e,t){let i=s.GetKeyByValue(t.UUIDSessions,e.sessionUUID),n=null!=e.call_type?e.call_type:"one_to_one";null!=e.responseCode&&487==e.responseCode?t.emit("call",{type:"MISSED_CALL",message:"Session canceled/Missed Call",from:i,call_type:e.media_type,session:n}):t.emit("call",{type:"CALL_ENDED",message:"Call is being ended",from:i,call_type:n})}SessionInvite(e,t){s.GetKeyByValue(t.UUIDSessions,e.sessionUUID);let i=t.UUIDSessionTypes[e.sessionUUID];if(null!=e.responseCode)switch(e.responseCode){case 100:t.emit("call",{type:"TRYING",message:"Trying to find the receiver",to:t.to,call_typ:i});break;case 180:t.emit("call",{type:"CONNECTING",message:"Trying to connect the receiver",to:t.to,call_typ:i});break;case 183:t.emit("call",{type:"ALERTING",message:"Alerting the receiver",to:t.to,call_typ:i});break;case 200:t.emit("call",{type:"CALL_ACCEPTED",message:"Call is accepted by receiver",to:t.to,call_typ:i});break;case 404:"one_to_one"==i&&t.DisposeWebrtc(!0),t.emit("call",{type:"INVALID_TARGET",message:"Receiver is not found",to:t.to,call_typ:i});break;default:"one_to_one"==i&&t.DisposeWebrtc(!0),t.emit("call",{type:"CALL_REJECTED",message:"Receiver has rejected the call",to:t.to,call_typ:i})}}SessionCancel(e,t){let i=s.GetKeyByValue(t.UUIDSessions,e.sessionUUID),n=t.UUIDSessionTypes[e.sessionUUID];if(null!=e.responseCode)switch(e.responseCode){case 487:t.emit("call",{type:"MISSED_CALL",message:"Session canceled/Missed Call",from:i,call_type:n});break;case 410:t.emit("call",{type:"PARTICIPANT_LEFT",message:"Participant has left the call",from:e.referenceID,call_typ:n});break;default:t.DisposeWebrtc(!1),t.emit("call",{type:"CALL_ENDED",message:"Call is being ended",to:t.to,call_typ:n})}}SetCallerStatus(e,t){t.emit("call",{type:"CALL_STATUS",message:"Call Status",video_status:e.videoInformation,audio_status:e.audioInformation})}PublicURL(e,t){t.emit("call",{type:"PUBLIC_URL",message:"Call is being ended",url:e.url})}SetExistingParticipants(e,t){t.emit("groupCall",{type:"PARTICIPANT_LIST",message:"Participant List is available",participant_list:e.referenceIDs})}SetParticipantStatus(e,t){t.emit("groupCall",{type:"PARTICIPANT_STATUS",message:"Participant Status",participant:e.referenceID,video_status:e.videoInformation,audio_status:e.audioInformation})}};t.default=n},function(e,t,i){var s=i(16);t.WebRtcPeer=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(12);const n=new class{constructor(){}async Authorization(e,t){let i={project_id:e,auth_token:t};return fetch(s.SERVER+"/AuthenticateSDK",{method:"POST",body:JSON.stringify(i),mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(e=>e.json()).then(e=>e).catch(e=>(console.log(e),e))}};t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(13);t.default=class{constructor(){this.RegPacket=s.default}set id(e){this.RegPacket.id=e}get id(){return this.RegPacket.id}set type(e){this.RegPacket.type=e}get type(){return this.RegPacket.type}set requestType(e){this.RegPacket.requestType=e}get requestType(){return this.RegPacket.requestType}set requestID(e){this.RegPacket.requestID=e}get requestID(){return this.RegPacket.requestID}set tenantID(e){this.RegPacket.tenantID=e}get tenantID(){return this.RegPacket.tenantID}set projectID(e){this.RegPacket.projectID=e}get projectID(){return this.RegPacket.projectID}set referenceID(e){this.RegPacket.referenceID=e}get referenceID(){return this.RegPacket.referenceID}set authorizationToken(e){this.RegPacket.authorizationToken=e}get authorizationToken(){return this.RegPacket.authorizationToken}set socketType(e){this.RegPacket.socketType=e}get socketType(){return this.RegPacket.socketType}SendRegisterRequest(e){const t=JSON.stringify(this.RegPacket);console.log("Send===RegisterRequest",t),e.send(t)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=new class{constructor(){}SetRegisterResponse(e,t){switch(e.responseCode){case 200:t.McToken=e.mcToken,t.emit("register",{type:"Success",message:"You are registered successfully with vidtok server."});break;default:t.emit("error",{type:"Register",message:"You are not registered with vidtok server."+e.responseMessage})}}};t.default=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(14);t.default=class{constructor(){this.ReqPacket=s.default}set from(e){this.ReqPacket.from=e}get from(){return this.ReqPacket.from}set to(e){this.ReqPacket.to=e}get to(){return this.ReqPacket.to}set type(e){this.ReqPacket.type=e}get type(){return this.ReqPacket.type}set requestType(e){this.ReqPacket.requestType=e}get requestType(){return this.ReqPacket.requestType}set session_type(e){this.ReqPacket.session_type=e}get session_type(){return this.ReqPacket.session_type}set requestID(e){this.ReqPacket.requestID=e}get requestID(){return this.ReqPacket.requestID}set sessionUUID(e){this.ReqPacket.sessionUUID=e}get sessionUUID(){return this.ReqPacket.sessionUUID}set mcToken(e){this.ReqPacket.mcToken=e}get mcToken(){return this.ReqPacket.mcToken}set sdpOffer(e){this.ReqPacket.sdpOffer=e}get sdpOffer(){return this.ReqPacket.sdpOffer}set call_type(e){this.ReqPacket.call_type=e}get call_type(){return this.ReqPacket.call_type}set media_type(e){this.ReqPacket.media_type=e}get media_type(){return this.ReqPacket.media_type}custon_field(e,t){this.ReqPacket[e]=t}SendCallRequest(e){let t=JSON.stringify(this.ReqPacket);console.log("Send===CallRequest",t),e.send(t)}}},function(e,t){var i=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(e){return null!=e.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{push:"ssrcGroups",reg:/^ssrc-group:(\w*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{push:"invalid",names:["value"]}]};Object.keys(i).forEach((function(e){i[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Broadcast=t.ManyToMany=t.Confrence=t.Client=t.version=t.name=void 0;const s=i(10).LIBRARY_VERSION;t.version=s;t.name="vdotok-call";const n=i(11);t.Client=n.default;const r=i(38);t.Confrence=r.default;const o=i(39);t.ManyToMany=o.default;const a=i(40);t.Broadcast=a.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LIBRARY_VERSION=void 0,t.LIBRARY_VERSION="0.0.1"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(2),r=i(4),o=i(5),a=i(6),c=i(7),l=i(1),d=i(15),u=i(3),p=navigator.mediaDevices;class h extends s.EventEmitter{constructor(e){super(),this.UUIDSessions={},this.UUIDSessionTypes={},this.UUIDSessionMediaTypes={},this.videoStatus=1,this.audioStatus=1,this.isManyToMany=!1,this.manyToMany={},this.participantsInCall=0,this.projectID=e.projectID,this.projectSecret=e.secret,this.Authentication(e)}set McToken(e){this.mcToken=e}get McToken(){return this.mcToken}Authentication(e){console.log("====DER===",e,this.projectID,this.projectSecret,this.clientToken),e.host?this.Connect(e.host):r.default.Authorization(e.projectID,e.secret).then(e=>{if(console.log("===Authorization-outer===",e),e&&200==e.status){let t=`${e.media_server_map.protocol}://${e.media_server_map.host}:${e.media_server_map.port}/${e.media_server_map.end_point}`;this.Connect(t),console.log("===Authorization===",e)}else n.default.OnAuthError(e.message,this)})}Connect(e){var t=new WebSocket(e);t.onmessage=e=>{var t=JSON.parse(e.data);switch(console.log("Received message: ",t),t.requestType){case"register":a.default.SetRegisterResponse(t,this);break;case"callResponse":console.log(" CallResponse: ",t),this.CallResponse(t);break;case"incomingCall":this.callSession=t.sessionUUID,this.currentFromUser=t.from,this.UUIDSessions[t.from]=t.sessionUUID,this.UUIDSessionTypes[t.sessionUUID]=t.call_type,this.UUIDSessionMediaTypes[t.from]=t.media_type,this.mediaType=t.media_type,this.isManyToMany="many_to_many"==t.call_type,console.log("incomingCall case: ",e),n.default.OnIncomingCall(t,this);break;case"startCommunication":this.SessionStart(t);break;case"stopCommunication":console.info("Communication ended by remote peer"),this.StopSession(t);break;case"iceCandidate":this.AddCandidate(t);break;case"session_invite":this.SessionInvite(t);break;case"session_cancel":case"session_break":this.SessionCancel(t);break;case"state_information":console.log("===onParticipantOffer== exiting left",t,(new Date).toLocaleTimeString()),this.SetCallerStatus(t);break;case"existing_participants":console.log("===onParticipantOffer== exiting",t,(new Date).toLocaleTimeString()),this.OnExistingParticipants(t);break;case"new_participant_arrived":console.log("===onParticipantOffer== exiting new",t,(new Date).toLocaleTimeString()),this.OnNewParticipant(t);break;case"participantLeft":console.log("===onParticipantOffer== exiting left",t,(new Date).toLocaleTimeString()),this.OnParticipantLeft(t);break;case"publicURL":console.log("===publicURL",t,(new Date).toLocaleTimeString()),this.OnPublicURL(t);break;case"ping":this.SendPacket({requestType:"pong",mcToken:this.McToken})}},t.onclose=e=>{n.default.OnDisconnection(e,this),console.log("OnClose socket==",e)},t.onopen=e=>{n.default.OnConnection(e,this),console.log("OnOpen socket==",e)},t.onerror=e=>{n.default.OnDisconnection(e,this),console.log("OnError socket==",e)},this.ws=t}Call(e){this.mediaType="video",this.to=Array.isArray(e.to)?e.to:[e.to],this.currentFromUser=this.currentUser,this.localVideo=e.localVideo,l.SetPlaysInline(this.localVideo);var t={localVideo:e.localVideo,remoteVideo:e.remoteVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new u.WebRtcPeer.WebRtcPeerSendrecv(t,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferCall(e,t,"video")})})}AudioCall(e){this.mediaType="audio",this.to=Array.isArray(e.to)?e.to:[e.to],this.currentFromUser=this.currentUser,this.localVideo=e.localVideo,l.SetPlaysInline(this.localVideo);var t={localVideo:e.localVideo,remoteVideo:e.remoteVideo,mediaConstraints:{audio:!0,video:!1},onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new u.WebRtcPeer.WebRtcPeerSendrecv(t,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferCall(e,t,"audio")})})}OnPublicURL(e){n.default.PublicURL(e,this)}OnExistingParticipants(e){this.isManyToMany&&this.manyToMany.OnExistingParticipants(e)}OnNewParticipant(e){this.participantsInCall=e.total_participants?e.total_participants-1:this.participantsInCall+1,this.isManyToMany&&this.manyToMany.OnNewParticipant(e)}OnParticipantLeft(e){this.participantsInCall>0&&this.participantsInCall--,this.isManyToMany&&this.manyToMany.OnParticipantLeft(e)}StopSession(e){this.isManyToMany||(n.default.SessionEnd(e,this),this.DisposeWebrtc(!0))}SessionInvite(e){this.isManyToMany||n.default.SessionInvite(e,this)}SessionCancel(e){this.participantsInCall>0&&this.participantsInCall--,this.isManyToMany?this.manyToMany.OnSessionCancel(e):n.default.SessionCancel(e,this)}SetCallerStatus(e){this.isManyToMany?this.manyToMany.SetParticipantStatus(e):n.default.SetCallerStatus(e,this)}async AddCandidate(e){this.rtcPears?await this.rtcPears.addIceCandidate(e.candidate):this.isManyToMany?this.manyToMany.AddCandidate(e):this.webRtcPeer.addIceCandidate(e.candidate,e=>{if(e)return n.default.OnAddCandidate(e,this),console.error("Error adding candidate: "+e)})}CallResponse(e){if(this.rtcPears){let t=new RTCSessionDescription({type:"answer",sdp:e.sdpAnswer});this.rtcPears.setRemoteDescription(t)}else this.isManyToMany?this.manyToMany.CallResponse(e):(n.default.OnCallResponse(e,this),console.info("CallResponse",this.webRtcPeer,e),"accepted"==e.response&&this.webRtcPeer.processAnswer(e.sdpAnswer,e=>{if(e)return n.default.SessionSDP(e,this),console.error(e)}))}SessionStart(e){if(this.rtcPears){let t=new RTCSessionDescription({type:"answer",sdp:e.sdpAnswer});this.rtcPears.setRemoteDescription(t)}else this.isManyToMany?this.manyToMany.SessionStart(e):(n.default.SessionStart(e,this),this.webRtcPeer.processAnswer(e.sdpAnswer,e=>{if(e)return n.default.SessionSDP(e,this),console.error(e)}))}AcceptCall(e,t){this.localVideo=e;let i=this.currentFromUser;var s={mediaConstraints:{audio:!0,video:"audio"!=this.mediaType},localVideo:e,remoteVideo:t,onicecandidate:e=>{this.onIceCandidate(e,i)},onerror:this.onError};this.webRtcPeer=new u.WebRtcPeer.WebRtcPeerSendrecv(s,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferIncomingCall(e,t,i)})})}RejectCall(e){let t=this.currentFromUser,i={type:"response",from:t,requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[t],responseCode:496,responseMessage:"rejected"};this.SendPacket(i),this.DisposeWebrtc(!1)}onOfferIncomingCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the offer");let s={type:"request",requestType:"session_invite",sdpOffer:t,requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[i],responseCode:200,responseMessage:"accepted"};console.log("===OnOffering Answer",s),this.SendPacket(s)}Register(e,t){this.currentUser=e;let i=new o.default;i.requestID=(new Date).getTime().toString(),i.projectID=this.projectID,i.referenceID=e,i.authorizationToken=t,i.SendRegisterRequest(this.ws)}PulicBroadCast(e){e.broadcastType=1,e.to=[],this.Broadcasting(e)}PublicShareScreen(e){e.broadcastType=1;(new Date).getTime().toString(),(new Date).getTime().toString();this.ScreenSharingOld(e)}ScreenShare(e){e.broadcastType=1;(new Date).getTime().toString(),(new Date).getTime().toString();this.ScreenSharingOld(e)}ScreenSharing(e){this.localVideo=e.localVideo;p.getDisplayMedia({video:{cursor:"always"},audio:!1}).then(async t=>{this.mediaType="video",this.to=e.to,this.currentFromUser=this.currentUser;let i=(new Date).getTime().toString(),s=e.hasOwnProperty("broadcastType")?e.broadcastType:0;const n=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});this.rtcPears=n;const r=await n.createOffer();await n.setLocalDescription(r),this.onOfferOneToManyCall(null,r.sdp,i,"",s,"screen"),n.addEventListener("icecandidate",e=>{e.candidate&&this.onIceCandidate(e.candidate,this.currentUser)}),n.addEventListener("connectionstatechange",e=>{"connected"===n.connectionState&&console.log("Peers-connected:::")}),n.addEventListener("track",async e=>{}),t.getTracks().forEach(e=>{n.addTrack(e,t)}),e.localVideo.srcObject=t,e.localVideo.play()})}ScreenSharingOld(e){this.mediaType="video",this.to=e.to,this.currentFromUser=this.currentUser,this.localVideo=e.localVideo;let t=e.hasOwnProperty("sessionUUID")?e.sessionUUID:(new Date).getTime().toString(),i=e.hasOwnProperty("associatedSessionUUID")?e.associatedSessionUUID:"",s=e.hasOwnProperty("broadcastType")?e.broadcastType:0;const n={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height}}};l.SetPlaysInline(this.localVideo);var r={localVideo:e.localVideo,mediaConstraints:n,sendSource:"desktop",onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new u.WebRtcPeer.WebRtcPeerSendrecv(r,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,n)=>{this.onOfferOneToManyCall(e,n,t,i,s,"screen")})})}Broadcasting(e){this.mediaType="video",this.to=e.to,this.currentFromUser=this.currentUser,this.localVideo=e.localVideo;let t=e.hasOwnProperty("sessionUUID")?e.sessionUUID:(new Date).getTime().toString(),i=e.hasOwnProperty("associatedSessionUUID")?e.associatedSessionUUID:"",s=e.hasOwnProperty("broadcastType")?e.broadcastType:0;l.SetPlaysInline(this.localVideo);var n={localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new u.WebRtcPeer.WebRtcPeerSendonly(n,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,n)=>{this.onOfferOneToManyCall(e,n,t,i,s,"call")})})}onOfferOneToManyCall(e,t,i,s,r,o){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);this.UUIDSessions[this.currentUser]=i,this.UUIDSessionTypes[i]="one_to_many";let a=new c.default;a.from=this.currentUser,a.to=this.to,a.requestID=i,a.sessionUUID=i,a.mcToken=this.McToken,a.sdpOffer=t,a.call_type="one_to_many",a.session_type=o,a.custon_field("broadcastType",r),a.custon_field("associatedSessionUUID",s),a.SendCallRequest(this.ws)}AcceptBroadcast(e){let t=this.currentFromUser;this.mediaType="video",l.SetPlaysInline(e);var i={remoteVideo:e,onicecandidate:e=>{this.onIceCandidate(e,t)},onerror:this.onError};this.webRtcPeer=new u.WebRtcPeer.WebRtcPeerRecvonly(i,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,i)=>{this.onOfferIncomingCall(e,i,t)})})}onOfferCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let s=(new Date).getTime().toString(),r=new c.default;r.from=this.currentUser,r.to=this.to,r.requestID=s,r.sessionUUID=s,r.mcToken=this.McToken,r.sdpOffer=t,r.media_type=i,r.SendCallRequest(this.ws),this.UUIDSessions[this.currentUser]=s,this.UUIDSessionTypes[s]="one_to_one",console.log(" OnOfferCall :: :: ::",i)}DisposeWebrtc(e){if(this.webRtcPeer){if(this.webRtcPeer.dispose(),this.webRtcPeer=null,e){var t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[this.currentFromUser],mcToken:"f3101a4f686d4dd7993ded88d9e386e5"};this.SendPacket(t)}let i=this.UUIDSessions[this.currentFromUser];delete this.UUIDSessionTypes[i],delete this.UUIDSessions[this.currentFromUser]}}onError(e){n.default.OnRTCPeer(e,this)}onIceCandidate(e,t){console.log("Local candidate"+JSON.stringify(e));var i={id:"onIceCandidate",requestType:"onIceCandidate",type:"request",candidate:e,referenceID:t,sessionUUID:this.UUIDSessions[t]};this.SendPacket(i)}SendPacket(e){var t=JSON.stringify(e);console.log("Sending message: "+t),null!=this.ws?this.ws.send(t):n.default.OnAuthInitialError("",this)}EndCall(){let e=this.currentFromUser,t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[e],mcToken:this.McToken};this.SendPacket(t),this.DisposeWebrtc(!1)}CancelCall(){let e=this.currentFromUser,t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[e],mcToken:this.McToken};this.SendPacket(t),this.DisposeWebrtc(!1)}SetMicMute(){if(this.localVideo&&null!=this.localVideo){let e="video"==this.mediaType&&1==this.videoStatus?1:0;this.audioStatus=0;let t=this.isManyToMany?this.callSession:this.UUIDSessions[this.currentFromUser],i={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:t,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:this.audioStatus,videoInformation:e};this.SendPacket(i),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!1),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!1)}}SetMicUnmute(){if(this.localVideo&&null!=this.localVideo){let e="video"==this.mediaType&&1==this.videoStatus?1:0;this.audioStatus=1;let t=this.isManyToMany?this.callSession:this.UUIDSessions[this.currentFromUser],i={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:t,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:this.audioStatus,videoInformation:e};this.SendPacket(i),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!0),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!0)}}SetCameraOn(){if(this.localVideo&&null!=this.localVideo){this.videoStatus=1;let e=this.isManyToMany?this.callSession:this.UUIDSessions[this.currentFromUser],t={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:e,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:this.audioStatus,videoInformation:1};this.SendPacket(t),this.localVideo.srcObject.getVideoTracks()[0].enabled=!0}}SetCameraOff(){if(this.localVideo&&null!=this.localVideo){this.videoStatus=0;let e=this.isManyToMany?this.callSession:this.UUIDSessions[this.currentFromUser],t={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:e,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:this.audioStatus,videoInformation:0};this.SendPacket(t),this.localVideo.srcObject.getVideoTracks()[0].enabled=!1}}GroupCall(e){let t=new d.default(this);this.localVideo=e.localVideo,this.manyToMany=t,this.isManyToMany=!0,this.manyToMany.GroupCall(e)}JoinGroupCall(e){let t=new d.default(this);t.callSession=this.callSession,t.mediaType=this.mediaType,this.localVideo=e.localVideo,this.manyToMany=t,this.mediaType=e.call_type,this.localVideo=e.localVideo,this.isManyToMany=!0,this.manyToMany.JoinGroupCall(e,this.callSession)}SetParticipantVideo(e,t){this.manyToMany.SetParticipantVideo(e,t)}LeaveGroupCall(){this.manyToMany.LeaveGroupCall()}}t.default=h},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SERVER=void 0,t.SERVER="https://vtkapi.vdotok.dev/API/v0"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={requestType:"register",type:"request",requestID:"YX9BLHSS0WLCI6ESCS2D29T5UW2YFJSY",tenantID:"12345",projectID:"12345",referenceID:"0d00e363ef75c8cc76d1ee79e950b30c",authorizationToken:"e2a10ce93bb2affbe767e843c0bfc76c",socketType:0}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={from:"User-A",to:"User-B",type:"request",requestType:"session_invite",session_type:"call",call_type:"one_to_one",media_type:"video",requestID:"UUID",sessionUUID:"sgdjkfgskjdgfs6876868",mcToken:"",sdpOffer:""}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(2),r=i(4),o=i(5),a=i(6),c=i(7),l=i(1),d=i(3);class u extends s.EventEmitter{constructor(e){super(),this.UUIDSessions={},this.UUIDSessionTypes={},this.UUIDSessionMediaTypes={},this.participants={},this.participantVideo={},this.callSession="",this.participatArray=[],this.mediaType="",this.instance={},this.mcToken=e.mcToken,this.currentUser=e.currentUser,this.instance=e,this.ws=e.ws}set McToken(e){this.mcToken=e}get McToken(){return this.mcToken}Authentication(e){console.log("====DER===",e,this.projectID,this.projectSecret,this.clientToken),r.default.Authorization(e.projectID,e.secret).then(e=>{if(console.log("===Authorization-outer===",e),e&&200==e.status){let t=`${e.media_server_map.protocol}://${e.media_server_map.host}:${e.media_server_map.port}/${e.media_server_map.end_point}`;this.Connect(t),console.log("===Authorization===",e)}else n.default.OnAuthError(e.message,this)})}Connect(e){var t=new WebSocket(e);t.onmessage=e=>{var t=JSON.parse(e.data);switch(console.log("Received message: ",t),t.requestType){case"register":a.default.SetRegisterResponse(t,this);break;case"callResponse":console.log(" CallResponse: ",t),this.CallResponse(t);break;case"incomingCall":this.callSession=t.sessionUUID,this.mediaType=t.media_type,console.log("incomingCall case: ",e),n.default.OnIncomingGroupCall(t,this);break;case"startCommunication":this.SessionStart(t);break;case"stopCommunication":console.info("Communication ended by remote peer",t);break;case"iceCandidate":this.AddCandidate(t);break;case"session_invite":break;case"session_cancel":this.OnSessionCancel(t),console.log("===onParticipantOffer== exiting session_cancel",t,(new Date).toLocaleTimeString());break;case"existing_participants":console.log("===onParticipantOffer== exiting",t,(new Date).toLocaleTimeString()),this.OnExistingParticipants(t);break;case"new_participant_arrived":console.log("===onParticipantOffer== exiting new",t,(new Date).toLocaleTimeString()),this.OnNewParticipant(t);break;case"participantLeft":console.log("===onParticipantOffer== exiting left",t,(new Date).toLocaleTimeString()),this.OnParticipantLeft(t);break;case"state_information":console.log("===onParticipantOffer== exiting left",t,(new Date).toLocaleTimeString()),n.default.SetParticipantStatus(t,this)}},t.onclose=e=>{n.default.OnDisconnection(e,this),console.log("OnClose socket==",e)},t.onopen=e=>{n.default.OnConnection(e,this),console.log("OnOpen socket==",e)},t.onerror=e=>{n.default.OnDisconnection(e,this),console.log("OnError socket==",e)},this.ws=t}SetParticipantStatus(e){n.default.SetParticipantStatus(e,this.instance)}AddCandidate(e){console.log("Add Ice Candidate::::",e,this.participants[e.referenceID]),this.participants[e.referenceID].addIceCandidate(e.candidate,e=>{if(e)return n.default.OnAddCandidate(e,this.instance),console.error("Error adding candidate: "+e)})}OnExistingParticipants(e){let t=e.referenceIDs;t.forEach(e=>{null!=e&&this.instance.emit("groupCall",{type:"NEW_PARTICIPANT",message:"New participant arrived.",participant:e})})}OnSessionCancel(e){let t=e.referenceID;this.instance.emit("groupCall",{type:"PARTICIPANT_LEFT",message:"Participant left.",participant:t});var i=this.participants[t];this.participatArray.splice(this.participatArray.indexOf(t),1),i&&null!=i&&i.dispose(),delete this.participants[t],delete this.participantVideo[t]}OnNewParticipant(e){let t=e.referenceID;null!=t&&-1==this.participatArray.indexOf(t)&&this.instance.emit("groupCall",{type:"NEW_PARTICIPANT",message:"New participant arrived.",participant:t})}OnParticipantLeft(e){let t=e.referenceID;this.instance.emit("groupCall",{type:"PARTICIPANT_LEFT",message:"Participant left.",participant:t})}SetParticipantVideo(e,t){l.SetPlaysInline(t);let i={remoteVideo:t,onicecandidate:t=>{this.OnParticipantIceCandidate(t,e)},onerror:this.onError},s=new d.WebRtcPeer.WebRtcPeerRecvonly(i,t=>{if(t)return console.error(t);s.generateOffer((t,i)=>{this.onParticipantOffer(t,i,e)})});return this.participants[e]=s,this.participantVideo[e]=t,t}CallResponse(e){console.info("CallResponse",this.participants[e.referenceID],e),"accepted"==e.response&&this.participants[e.referenceID].processAnswer(e.sdpAnswer,e=>{if(e)return n.default.SessionSDP(e,this),console.error(e)})}SessionStart(e){n.default.GroupSessionStart(e,this.instance),console.log("Start=Commm",e.referenceID,e.referenceID,this.participants[e.referenceID]),this.participants[e.referenceID].processAnswer(e.sdpAnswer,e=>{if(e)return n.default.SessionSDP(e,this),console.error(e)})}onOfferIncomingCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the offer");let s={type:"request",requestType:"session_invite",sdpOffer:t,requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,referenceID:this.currentUser,responseCode:200,responseMessage:"accepted"};console.log("===OnOffering Answer",s),this.SendPacket(s)}OnOfferManytoManyCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the offer");let s={type:"request",requestType:"session_invite",sdpOffer:t,requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,referenceID:this.currentUser,responseCode:200,responseMessage:"accepted"};console.log("===OnOffering Answer",s),this.SendPacket(s)}Register(e,t){this.currentUser=e;let i=new o.default;i.requestID=(new Date).getTime().toString(),i.tenantID=this.projectID,i.referenceID=e,i.authorizationToken=t,i.SendRegisterRequest(this.ws)}GroupCall(e){this.mediaType=e.call_type,this.to=Array.isArray(e.to)?e.to:[e.to],this.currentFromUser=this.currentUser,this.localVideo=e.localVideo,this.instance.to=this.to,l.SetPlaysInline(this.localVideo);var t={mediaConstraints:{audio:!0,video:"audio"!=e.call_type},localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};let i=new d.WebRtcPeer.WebRtcPeerSendonly(t,t=>{if(t)return console.error(t);i.generateOffer((t,i)=>{this.onManyToManyOfferCall(t,i,e.call_type)})});this.participants[this.currentUser]=i}JoinGroupCall(e,t){this.mediaType=e.call_type,this.localVideo=e.localVideo,this.callSession=t,l.SetPlaysInline(this.localVideo);var i={mediaConstraints:{audio:!0,video:"audio"!=e.call_type},localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};let s=new d.WebRtcPeer.WebRtcPeerSendonly(i,t=>{if(t)return console.error(t);s.generateOffer((t,i)=>{console.log("======here===it goes inner sess",this.callSession),this.onJoinManyToManyOfferCall(t,i,e.call_type)}),console.log("======here===it goes")});this.participants[this.currentUser]=s}Broadcasting(e){this.to=e.to,this.currentFromUser=this.currentUser,this.localVideo=e.localVideo;var t={localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new d.WebRtcPeer.WebRtcPeerSendonly(t,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferOneToManyCall(e,t)})})}onOfferOneToManyCall(e,t){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let i=(new Date).getTime().toString();this.UUIDSessions[this.currentUser]=i,this.UUIDSessionTypes[i]="one_to_many";let s=new c.default;s.from=this.currentUser,s.to=this.to,s.requestID=i,s.sessionUUID=i,s.mcToken=this.McToken,s.sdpOffer=t,s.call_type="one_to_many",s.SendCallRequest(this.ws)}AcceptBroadcast(e){let t=this.currentFromUser;var i={remoteVideo:e,onicecandidate:e=>{this.onIceCandidate(e,t)},onerror:this.onError};this.webRtcPeer=new d.WebRtcPeer.WebRtcPeerRecvonly(i,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,i)=>{this.onOfferIncomingCall(e,i,t)})})}onOfferCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let s=(new Date).getTime().toString(),r=new c.default;r.from=this.currentUser,r.to=this.to,r.requestID=s,r.sessionUUID=s,r.mcToken=this.McToken,r.sdpOffer=t,r.media_type=i,r.SendCallRequest(this.ws),this.UUIDSessions[this.currentUser]=s,this.UUIDSessionTypes[s]="one_to_one",console.log(" OnOfferCall :: :: ::",i)}onManyToManyOfferCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let s=(new Date).getTime().toString();this.callSession=s,this.instance.callSession=s;let r=new c.default;r.from=this.currentUser,r.to=this.to,r.requestID=s,r.sessionUUID=s,r.mcToken=this.McToken,r.sdpOffer=t,r.media_type=i,r.call_type="many_to_many",r.SendCallRequest(this.ws),console.log(" OnOfferCall :: :: ::",i)}onJoinManyToManyOfferCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);console.log("======here===it goes inner",i);let s=(new Date).getTime().toString(),r=this.callSession;console.log("======here===it goes sess",r);var o={from:this.currentUser,sdpOffer:t,responseCode:200,responseMessage:"accepted",requestType:"session_invite",type:"request",session_type:"call",call_type:"many_to_many",media_type:i,requestID:s,sessionUUID:this.callSession,mcToken:this.mcToken};this.SendPacket(o)}onParticipantOffer(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let s=(new Date).getTime().toString();var r={from:this.currentUser,to:i,requestType:"to_receive_stream",sdpOffer:t,requestID:s,type:"request",sessionUUID:this.callSession,mcToken:this.McToken};console.log("===onParticipantOffer==",r),this.SendPacket(r)}DisposeWebrtc(e){for(var t in this.participants){let e=this.participants[t];e&&null!=e&&e.dispose()}this.participants={},this.participantVideo={},this.callSession="",this.participatArray=[]}onError(e){n.default.OnRTCPeer(e,this)}onIceCandidate(e,t){console.log("Local candidate"+JSON.stringify(e));var i={requestType:"onIceCandidate",candidate:e,referenceID:t,sessionUUID:this.callSession};this.SendPacket(i)}SendPacket(e){var t=JSON.stringify(e);console.log("Sending message: "+t),null!=this.ws?this.ws.send(t):n.default.OnAuthInitialError("",this)}OnParticipantIceCandidate(e,t){var i={requestType:"onIceCandidate",candidate:e,referenceID:t,sessionUUID:this.callSession};this.SendPacket(i)}SetMicMute(){if(this.localVideo&&null!=this.localVideo){let e="video"==this.mediaType?1:0,t={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:0,videoInformation:e};this.SendPacket(t),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!1),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!1)}}SetMicUnmute(){if(this.localVideo&&null!=this.localVideo){let e="video"==this.mediaType?1:0,t={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:e};this.SendPacket(t),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!0),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!0)}}SetCameraOn(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:1};this.SendPacket(e),this.localVideo.srcObject.getVideoTracks()[0].enabled=!0}}SetCameraOff(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:0};this.SendPacket(e),this.localVideo.srcObject.getVideoTracks()[0].enabled=!1}}LeaveGroupCall(){let e={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken};this.SendPacket(e),this.DisposeWebrtc(!1)}CancelCall(){let e=this.currentFromUser,t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[e],mcToken:this.McToken};this.SendPacket(t),this.DisposeWebrtc(!1)}}t.default=u},function(e,t,i){var s=i(17),n=i(21),r=i(22),o=i(23),a=i(26),c=i(0).EventEmitter,l=i(28).recursive.bind(void 0,!0),d=i(30),u="undefined"==typeof window?console:window.Logger||console;try{i(37)}catch(e){"undefined"==typeof getScreenConstraints&&(u.warn("screen sharing is not available"),getScreenConstraints=function(e,t){t(new Error("This library is not enabled for screen sharing"))})}var p={audio:!0,video:{width:640,framerate:15}},h=new r("undefined"!=typeof window&&window.navigator?window.navigator.userAgent:"").getBrowser();"IE"===h.name&&function(e){var t=document.createElement("script");t.src=e;var i=document.querySelector("script");i.parentNode.insertBefore(t,i)}("https://cdn.temasys.io/adapterjs/0.15.x/adapter.debug.js");var f=!1;function m(e){e&&u.error(e)}function g(e){e.stop&&e.stop()}function y(e){e.getTracks().forEach(g)}"Chrome"!==h.name&&"Chromium"!==h.name||(u.debug(h.name+": using SDP PlanB"),f=!0);var v=function(e){return null==e?"":"type: "+e.type+"\r\n"+e.sdp};function w(e,t){var i=[];return function(e,t){"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?t.onsignalingstatechange=e:t.addEventListener("signalingstatechange",e)}((function(){if("stable"===e.signalingState)for(;i.length;){var t=i.shift();e.addIceCandidate(t.candidate,t.callback,t.callback)}}),e),function(s,n){switch(n=n||t,e.signalingState){case"closed":n(new Error("PeerConnection object is closed"));break;case"stable":if(e.remoteDescription){e.addIceCandidate(s,n,n);break}default:i.push({candidate:s,callback:n})}}}function S(e){var t=e.getVideoTracks();if(!t.length)return u.warn("No video tracks available in the video stream"),"";var i=["a=x-google-flag:conference","a=ssrc-group:SIM 1 2 3","a=ssrc:1 cname:localVideo","a=ssrc:1 msid:"+e.id+" "+t[0].id,"a=ssrc:1 mslabel:"+e.id,"a=ssrc:1 label:"+t[0].id,"a=ssrc:2 cname:localVideo","a=ssrc:2 msid:"+e.id+" "+t[0].id,"a=ssrc:2 mslabel:"+e.id,"a=ssrc:2 label:"+t[0].id,"a=ssrc:3 cname:localVideo","a=ssrc:3 msid:"+e.id+" "+t[0].id,"a=ssrc:3 mslabel:"+e.id,"a=ssrc:3 label:"+t[0].id];return i.push(""),i.join("\n")}function b(e,t,i){if(!(this instanceof b))return new b(e,t,i);b.super_.call(this),t instanceof Function&&(i=t,t=void 0),t=t||{},i=(i||m).bind(this);var n,r=this,a=t.localVideo,g=t.remoteVideo,y=t.videoStream,T=t.audioStream,I=t.mediaConstraints,D=t.peerConnection,C=t.sendSource||"webcam",U=t.dataChannelConfig,k=t.dataChannels||!1,O=o(),P=l({iceServers:s()},t.configuration),_=t.onicecandidate;_&&this.on("icecandidate",_);var R=t.oncandidategatheringdone;R&&this.on("candidategatheringdone",R);var A=t.simulcast,E=t.multistream,M=new d.Interop,V=[],q=!1;if(Object.defineProperties(this,{peerConnection:{get:function(){return D}},id:{value:t.id||O,writable:!1},remoteVideo:{get:function(){return g}},localVideo:{get:function(){return a}},dataChannel:{get:function(){return n}},currentFrame:{get:function(){if(g){if(g.readyState<g.HAVE_CURRENT_DATA)throw new Error("No video stream data available");var e=document.createElement("canvas");return e.width=g.videoWidth,e.height=g.videoHeight,e.getContext("2d").drawImage(g,0,0),e}}}}),!D&&(D=new RTCPeerConnection(P),k&&!n)){var L="WebRtcPeer-"+r.id,x=void 0;U&&(L=U.id||L,x=U.options),n=D.createDataChannel(L,x),U&&(n.onopen=U.onopen,n.onclose=U.onclose,n.onmessage=U.onmessage,n.onbufferedamountlow=U.onbufferedamountlow,n.onerror=U.onerror||m)}!D.getLocalStreams&&D.getSenders&&(D.getLocalStreams=function(){var e=new MediaStream;return D.getSenders().forEach((function(t){e.addTrack(t.track)})),[e]}),!D.getRemoteStreams&&D.getReceivers&&(D.getRemoteStreams=function(){var e=new MediaStream;return D.getReceivers().forEach((function(t){e.addTrack(t.track)})),[e]});!function(e,t){"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?t.onicecandidate=e:t.addEventListener("icecandidate",e)}((function(e){var t,i=e.candidate;c.listenerCount(r,"icecandidate")||c.listenerCount(r,"candidategatheringdone")?i?(t=E&&f?M.candidateToUnifiedPlan(i):i,"undefined"==typeof AdapterJS&&r.emit("icecandidate",t),q=!1):q||("undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?c.prototype.emit("candidategatheringdone",t):r.emit("candidategatheringdone"),q=!0):q||(V.push(i),i||(q=!0))}),D),D.onaddstream=t.onaddstream,D.onnegotiationneeded=t.onnegotiationneeded,this.on("newListener",(function(e,t){if("icecandidate"===e||"candidategatheringdone"===e)for(;V.length;){var i=V.shift();!i==("candidategatheringdone"===e)&&t(i)}}));var j=w(D);function N(){if(g){g.pause();var e=D.getRemoteStreams()[0];g.srcObject=e,u.debug("Remote stream:",e),"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?g=attachMediaStream(g,e):g.load()}}function W(e){var t,i;return A&&("Chrome"===h.name||"Chromium"===h.name?(u.debug("Adding multicast info"),e=new RTCSessionDescription({type:e.type,sdp:(t=e.sdp,i=t.indexOf("a=ssrc-group:FID"),(i>0?t.slice(0,i):t)+S(y))})):u.warn("Simulcast is only available in Chrome browser.")),e}function B(){"closed"===D.signalingState&&i('The peer connection object is in "closed" state. This is most likely due to an invocation of the dispose method before accepting in the dialogue'),y&&a&&r.showLocalVideo(),y&&y.getTracks().forEach((function(e){D.addTrack(e,y)})),T&&T.getTracks().forEach((function(e){D.addTrack(e,T)})),i()}if(this.addIceCandidate=function(e,t){var i;i=E&&f?M.candidateToPlanB(e):new RTCIceCandidate(e),u.debug("Remote ICE candidate received",e),t=(t||m).bind(this),j(i,t)},this.generateOffer=function(t){if(t=t.bind(this),"recvonly"===e){var i=!I||"boolean"!=typeof I.audio||I.audio,s=!I||"boolean"!=typeof I.video||I.video;i&&D.addTransceiver("audio",{direction:"recvonly"}),s&&D.addTransceiver("video",{direction:"recvonly"})}else"sendonly"===e&&D.getTransceivers().forEach((function(e){e.direction="sendonly"}));if("undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9){var n=function(){!function(e){for(var t=(new Date).getTime(),i=0;i<1e7&&!((new Date).getTime()-t>e);i++);}(1e3);var e=D.localDescription;u.debug("Local description set\n",e.sdp),E&&f&&(e=M.toUnifiedPlan(e),u.debug("offer::origPlanB->UnifiedPlan",v(e))),t(null,e.sdp,r.processAnswer.bind(r))};D.createOffer((function(e){u.debug("Created SDP offer"),u.debug("Local description set\n",D.localDescription),D.setLocalDescription(e,n,t)}),t)}else D.createOffer().then((function(e){return u.debug("Created SDP offer"),e=W(e),D.setLocalDescription(e)})).then((function(){var e=D.localDescription;u.debug("Local description set\n",e.sdp),E&&f&&(e=M.toUnifiedPlan(e),u.debug("offer::origPlanB->UnifiedPlan",v(e))),t(null,e.sdp,r.processAnswer.bind(r))})).catch(t)},this.getLocalSessionDescriptor=function(){return D.localDescription},this.getRemoteSessionDescriptor=function(){return D.remoteDescription},this.showLocalVideo=function(){a.srcObject=y,a.muted=!0,"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9&&(a=attachMediaStream(a,y))},this.send=function(e){n&&"open"===n.readyState?n.send(e):u.warn("Trying to send data over a non-existing or closed data channel")},this.processAnswer=function(e,t){t=(t||m).bind(this);var i=new RTCSessionDescription({type:"answer",sdp:e});if(E&&f){var s=M.toPlanB(i);u.debug("asnwer::planB",v(s)),i=s}if(u.debug("SDP answer received, setting remote description"),"closed"===D.signalingState)return t("PeerConnection is closed");D.setRemoteDescription(i).then((function(){N(),t()}),t)},this.processOffer=function(e,t){t=t.bind(this);var i=new RTCSessionDescription({type:"offer",sdp:e});if(E&&f){var s=M.toPlanB(i);u.debug("offer::planB",v(s)),i=s}if(u.debug("SDP offer received, setting remote description"),"closed"===D.signalingState)return t("PeerConnection is closed");D.setRemoteDescription(i).then((function(){return N()})).then((function(){return D.createAnswer()})).then((function(e){return e=W(e),u.debug("Created SDP answer"),D.setLocalDescription(e)})).then((function(){var e=D.localDescription;E&&f&&(e=M.toUnifiedPlan(e),u.debug("answer::origPlanB->UnifiedPlan",v(e))),u.debug("Local description set\n",e.sdp),t(null,e.sdp)})).catch(t)},"recvonly"===e||y||T)setTimeout(B,0);else{function F(e){void 0===e&&(e=p),"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?navigator.getUserMedia(e,(function(e){y=e,B()}),i):navigator.mediaDevices.getUserMedia(e).then((function(e){y=e,B()})).catch(i)}"webcam"===C?F(I):getScreenConstraints(C,(function(e,t){if(e)return i(e);constraints=[I],constraints.unshift(t),F(l.apply(void 0,constraints))}),O)}this.on("_dispose",(function(){a&&(a.pause(),a.srcObject=null,"undefined"==typeof AdapterJS&&a.load(),a.muted=!1),g&&(g.pause(),g.srcObject=null,"undefined"==typeof AdapterJS&&g.load()),r.removeAllListeners(),"undefined"!=typeof window&&void 0!==window.cancelChooseDesktopMedia&&window.cancelChooseDesktopMedia(O)}))}function T(e){var t="get"+e+"Tracks";return{enumerable:!0,get:function(){if(this.peerConnection){var e=this.peerConnection.getLocalStreams();if(e.length){for(var i,s=0;i=e[s];s++)for(var n,r=i[t](),o=0;n=r[o];o++)if(!n.enabled)return!1;return!0}}},set:function(e){function i(t){t.enabled=e}this.peerConnection.getLocalStreams().forEach((function(e){e[t]().forEach(i)}))}}}function I(e,t){if(!(this instanceof I))return new I(e,t);I.super_.call(this,"recvonly",e,t)}function D(e,t){if(!(this instanceof D))return new D(e,t);D.super_.call(this,"sendonly",e,t)}function C(e,t){if(!(this instanceof C))return new C(e,t);C.super_.call(this,"sendrecv",e,t)}n(b,c),Object.defineProperties(b.prototype,{enabled:{enumerable:!0,get:function(){return this.audioEnabled&&this.videoEnabled},set:function(e){this.audioEnabled=this.videoEnabled=e}},audioEnabled:T("Audio"),videoEnabled:T("Video")}),b.prototype.getLocalStream=function(e){if(this.peerConnection)return this.peerConnection.getLocalStreams()[e||0]},b.prototype.getRemoteStream=function(e){if(this.peerConnection)return this.peerConnection.getRemoteStreams()[e||0]},b.prototype.dispose=function(){u.debug("Disposing WebRtcPeer");var e=this.peerConnection,t=this.dataChannel;try{if(t){if("closed"===t.readyState)return;t.close()}if(e){if("closed"===e.signalingState)return;e.getLocalStreams().forEach(y),e.close()}}catch(e){u.warn("Exception disposing webrtc peer "+e)}"undefined"==typeof AdapterJS&&this.emit("_dispose")},n(I,b),n(D,b),n(C,b),t.bufferizeCandidates=w,t.WebRtcPeerRecvonly=I,t.WebRtcPeerSendonly=D,t.WebRtcPeerSendrecv=C,t.hark=function(e,t){return a(e,t)}},function(e,t,i){"use strict";var s=i(18);e.exports=function(e){var t,n={stun:(e||{}).stun||i(19),turn:(e||{}).turn||i(20)},r=(e||{}).stunCount||2,o=(e||{}).turnCount||0;function a(e,t){for(var i,r=[],o=[].concat(n[e]);o.length&&r.length<t;)i=Math.random()*o.length|0,r=r.concat(o.splice(i,1));return r.map((function(t){return"string"==typeof t||t instanceof String?s(e+":"+t):t}))}return t=[].concat(a("stun",r)),o&&(t=t.concat(a("turn",o))),t}},function(e,t){var i=["stun:","turn:"];e.exports=function(e){var t,s,n=(e||{}).url||e,r={};return"string"==typeof n||n instanceof String?(n=n.trim(),(t=i[i.indexOf(n.slice(0,5))])?(s=(n=n.slice(5)).split("@"),r.username=e.username,r.credential=e.credential,s.length>1&&(n=s[1],s=s[0].split(":"),r.username=s[0],r.credential=(e||{}).credential||s[1]||""),r.url=t+n,r.urls=[r.url],r):e):e}},function(e){e.exports=JSON.parse('["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"]')},function(e){e.exports=JSON.parse("[]")},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},function(e,t,i){var s;!function(n,r){"use strict";var o="model",a="name",c="type",l="vendor",d="version",u="mobile",p="tablet",h="smarttv",f={extend:function(e,t){var i={};for(var s in e)t[s]&&t[s].length%2==0?i[s]=t[s].concat(e[s]):i[s]=e[s];return i},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},m={rgx:function(e,t){for(var i,s,n,r,o,a,c=0;c<t.length&&!o;){var l=t[c],d=t[c+1];for(i=s=0;i<l.length&&!o;)if(o=l[i++].exec(e))for(n=0;n<d.length;n++)a=o[++s],"object"==typeof(r=d[n])&&r.length>0?2==r.length?"function"==typeof r[1]?this[r[0]]=r[1].call(this,a):this[r[0]]=r[1]:3==r.length?"function"!=typeof r[1]||r[1].exec&&r[1].test?this[r[0]]=a?a.replace(r[1],r[2]):void 0:this[r[0]]=a?r[1].call(this,a,r[2]):void 0:4==r.length&&(this[r[0]]=a?r[3].call(this,a.replace(r[1],r[2])):void 0):this[r]=a||void 0;c+=2}},str:function(e,t){for(var i in t)if("object"==typeof t[i]&&t[i].length>0){for(var s=0;s<t[i].length;s++)if(f.has(t[i][s],e))return"?"===i?void 0:i}else if(f.has(t[i],e))return"?"===i?void 0:i;return e}},g={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},y={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[a,d],[/(opios)[\/\s]+([\w\.]+)/i],[[a,"Opera Mini"],d],[/\s(opr)\/([\w\.]+)/i],[[a,"Opera"],d],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[a,d],[/(konqueror)\/([\w\.]+)/i],[[a,"Konqueror"],d],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[a,"IE"],d],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[a,"Edge"],d],[/(yabrowser)\/([\w\.]+)/i],[[a,"Yandex"],d],[/(Avast)\/([\w\.]+)/i],[[a,"Avast Secure Browser"],d],[/(AVG)\/([\w\.]+)/i],[[a,"AVG Secure Browser"],d],[/(puffin)\/([\w\.]+)/i],[[a,"Puffin"],d],[/(focus)\/([\w\.]+)/i],[[a,"Firefox Focus"],d],[/(opt)\/([\w\.]+)/i],[[a,"Opera Touch"],d],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[a,"UCBrowser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[a,/_/g," "],d],[/(windowswechat qbcore)\/([\w\.]+)/i],[[a,"WeChat(Win) Desktop"],d],[/(micromessenger)\/([\w\.]+)/i],[[a,"WeChat"],d],[/(brave)\/([\w\.]+)/i],[[a,"Brave"],d],[/(qqbrowserlite)\/([\w\.]+)/i],[a,d],[/(QQ)\/([\d\.]+)/i],[a,d],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[a,d],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[a,d],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[a,d],[/(MetaSr)[\/\s]?([\w\.]+)/i],[a],[/(LBBROWSER)/i],[a],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[d,[a,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[d,[a,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[a,d],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[d,[a,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[a,/(.+)/,"$1 WebView"],d],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[a,/(.+(?:g|us))(.+)/,"$1 $2"],d],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[d,[a,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[a,"Sailfish Browser"],d],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[a,d],[/(dolfin)\/([\w\.]+)/i],[[a,"Dolphin"],d],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[a,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[a,"Chrome"],d],[/(coast)\/([\w\.]+)/i],[[a,"Opera Coast"],d],[/fxios\/([\w\.-]+)/i],[d,[a,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[d,[a,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[d,a],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[a,"GSA"],d],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[a,[d,m.str,g.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[a,d],[/(navigator|netscape)\/([\w\.-]+)/i],[[a,"Netscape"],d],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[a,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",f.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",f.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",f.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[o,l,[c,p]],[/applecoremedia\/[\w\.]+ \((ipad)/],[o,[l,"Apple"],[c,p]],[/(apple\s{0,1}tv)/i],[[o,"Apple TV"],[l,"Apple"],[c,h]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[l,o,[c,p]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[o,[l,"Amazon"],[c,p]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[o,m.str,g.device.amazon.model],[l,"Amazon"],[c,u]],[/android.+aft([bms])\sbuild/i],[o,[l,"Amazon"],[c,h]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[o,l,[c,u]],[/\((ip[honed|\s\w*]+);/i],[o,[l,"Apple"],[c,u]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[l,o,[c,u]],[/\(bb10;\s(\w+)/i],[o,[l,"BlackBerry"],[c,u]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[o,[l,"Asus"],[c,p]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[l,"Sony"],[o,"Xperia Tablet"],[c,p]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[o,[l,"Sony"],[c,u]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[l,o,[c,"console"]],[/android.+;\s(shield)\sbuild/i],[o,[l,"Nvidia"],[c,"console"]],[/(playstation\s[34portablevi]+)/i],[o,[l,"Sony"],[c,"console"]],[/(sprint\s(\w+))/i],[[l,m.str,g.device.sprint.vendor],[o,m.str,g.device.sprint.model],[c,u]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[l,[o,/_/g," "],[c,u]],[/(nexus\s9)/i],[o,[l,"HTC"],[c,p]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29|ele-l29)/i],[o,[l,"Huawei"],[c,u]],[/android.+(bah2?-a?[lw]\d{2})/i],[o,[l,"Huawei"],[c,p]],[/(microsoft);\s(lumia[\s\w]+)/i],[l,o,[c,u]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[o,[l,"Microsoft"],[c,"console"]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[l,"Microsoft"],[c,u]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[o,[l,"Motorola"],[c,u]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[l,"Motorola"],[c,p]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,f.trim],[o,f.trim],[c,h]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[l,"Samsung"],[c,h]],[/\(dtv[\);].+(aquos)/i],[o,[l,"Sharp"],[c,h]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[l,"Samsung"],o,[c,p]],[/smart-tv.+(samsung)/i],[l,[c,h],o],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[l,"Samsung"],o,[c,u]],[/sie-(\w*)/i],[o,[l,"Siemens"],[c,u]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[l,"Nokia"],o,[c,u]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[o,[l,"Acer"],[c,p]],[/android.+([vl]k\-?\d{3})\s+build/i],[o,[l,"LG"],[c,p]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[l,"LG"],o,[c,p]],[/(lg) netcast\.tv/i],[l,o,[c,h]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[o,[l,"LG"],[c,u]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[l,o,[c,p]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[o,[l,"Lenovo"],[c,p]],[/(lenovo)[_\s-]?([\w-]+)/i],[l,o,[c,u]],[/linux;.+((jolla));/i],[l,o,[c,u]],[/((pebble))app\/[\d\.]+\s/i],[l,o,[c,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,o,[c,u]],[/crkey/i],[[o,"Chromecast"],[l,"Google"],[c,h]],[/android.+;\s(glass)\s\d/i],[o,[l,"Google"],[c,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[o,[l,"Google"],[c,p]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[o,[l,"Google"],[c,u]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]?[\w\s]+))\s+build/i],[[o,/_/g," "],[l,"Xiaomi"],[c,u]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]?[\w\s]+))\s+build/i],[[o,/_/g," "],[l,"Xiaomi"],[c,p]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[o,[l,"Meizu"],[c,u]],[/(mz)-([\w-]{2,})/i],[[l,"Meizu"],o,[c,u]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[o,[l,"OnePlus"],[c,u]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[o,[l,"RCA"],[c,p]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[o,[l,"Dell"],[c,p]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[o,[l,"Verizon"],[c,p]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[l,"Barnes & Noble"],o,[c,p]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[o,[l,"NuVision"],[c,p]],[/android.+;\s(k88)\sbuild/i],[o,[l,"ZTE"],[c,p]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[o,[l,"Swiss"],[c,u]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[o,[l,"Swiss"],[c,p]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[o,[l,"Zeki"],[c,p]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[l,"Dragon Touch"],o,[c,p]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[o,[l,"Insignia"],[c,p]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[o,[l,"NextBook"],[c,p]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[l,"Voice"],o,[c,u]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[l,"LvTel"],o,[c,u]],[/android.+;\s(PH-1)\s/i],[o,[l,"Essential"],[c,u]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[o,[l,"Envizen"],[c,p]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[l,o,[c,p]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[o,[l,"MachSpeed"],[c,p]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[l,o,[c,p]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[o,[l,"Rotor"],[c,p]],[/android.+(KS(.+))\s+build/i],[o,[l,"Amazon"],[c,p]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[l,o,[c,p]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[c,f.lowerize],l,o],[/[\s\/\(](smart-?tv)[;\)]/i],[[c,h]],[/(android[\w\.\s\-]{0,9});.+build/i],[o,[l,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[d,[a,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[d,[a,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[a,d],[/rv\:([\w\.]{1,9}).+(gecko)/i],[d,a]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[a,d],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[a,[d,m.str,g.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[a,"Windows"],[d,m.str,g.os.windows.version]],[/\((bb)(10);/i],[[a,"BlackBerry"],d],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[a,d],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[a,"Symbian"],d],[/\((series40);/i],[a],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[a,"Firefox OS"],d],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[a,d],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[a,"Chromium OS"],d],[/(sunos)\s?([\w\.\d]*)/i],[[a,"Solaris"],d],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[a,d],[/(haiku)\s(\w+)/i],[a,d],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[d,/_/g,"."],[a,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[a,"Mac OS"],[d,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[a,d]]},v=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof v))return new v(e,t).getResult();var i=e||(n&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:""),s=t?f.extend(y,t):y;return this.getBrowser=function(){var e={name:void 0,version:void 0};return m.rgx.call(e,i,s.browser),e.major=f.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return m.rgx.call(e,i,s.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return m.rgx.call(e,i,s.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return m.rgx.call(e,i,s.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return m.rgx.call(e,i,s.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this};v.VERSION="0.7.22",v.BROWSER={NAME:a,MAJOR:"major",VERSION:d},v.CPU={ARCHITECTURE:"architecture"},v.DEVICE={MODEL:o,VENDOR:l,TYPE:c,CONSOLE:"console",MOBILE:u,SMARTTV:h,TABLET:p,WEARABLE:"wearable",EMBEDDED:"embedded"},v.ENGINE={NAME:a,VERSION:d},v.OS={NAME:a,VERSION:d},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=v),t.UAParser=v):void 0===(s=function(){return v}.call(t,i,t,e))||(e.exports=s);var w=n&&(n.jQuery||n.Zepto);if(w&&!w.ua){var S=new v;w.ua=S.getResult(),w.ua.get=function(){return S.getUA()},w.ua.set=function(e){S.setUA(e);var t=S.getResult();for(var i in t)w.ua[i]=t[i]}}}("object"==typeof window?window:this)},function(e,t,i){var s=i(24),n=i(25);e.exports=function(e,t,i){var r=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[r+a]=o[a];return t||n(o)}},function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var s=new Uint8Array(16);e.exports=function(){return i(s),s}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},function(e,t){for(var i=[],s=0;s<256;++s)i[s]=(s+256).toString(16).substr(1);e.exports=function(e,t){var s=t||0,n=i;return[n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]]].join("")}},function(e,t,i){var s,n=i(27);"undefined"!=typeof window&&(s=window.AudioContext||window.webkitAudioContext);var r=null;e.exports=function(e,t){var i=new n;if(!s)return i;var o,a,c,l=(t=t||{}).smoothing||.1,d=t.interval||50,u=t.threshold,p=t.play,h=t.history||10,f=!0;r=t.audioContext||r||new s,(c=r.createAnalyser()).fftSize=512,c.smoothingTimeConstant=l,a=new Float32Array(c.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(o=r.createMediaElementSource(e),void 0===p&&(p=!0),u=u||-50):(o=r.createMediaStreamSource(e),u=u||-50),o.connect(c),p&&c.connect(r.destination),i.speaking=!1,i.suspend=function(){return r.suspend()},i.resume=function(){return r.resume()},Object.defineProperty(i,"state",{get:function(){return r.state}}),r.onstatechange=function(){i.emit("state_change",r.state)},i.setThreshold=function(e){u=e},i.setInterval=function(e){d=e},i.stop=function(){f=!1,i.emit("volume_change",-100,u),i.speaking&&(i.speaking=!1,i.emit("stopped_speaking")),c.disconnect(),o.disconnect()},i.speakingHistory=[];for(var m=0;m<h;m++)i.speakingHistory.push(0);var g=function(){setTimeout((function(){if(f){var e=function(e,t){var i=-1/0;e.getFloatFrequencyData(t);for(var s=4,n=t.length;s<n;s++)t[s]>i&&t[s]<0&&(i=t[s]);return i}(c,a);i.emit("volume_change",e,u);var t=0;if(e>u&&!i.speaking){for(var s=i.speakingHistory.length-3;s<i.speakingHistory.length;s++)t+=i.speakingHistory[s];t>=2&&(i.speaking=!0,i.emit("speaking"))}else if(e<u&&i.speaking){for(s=0;s<i.speakingHistory.length;s++)t+=i.speakingHistory[s];0==t&&(i.speaking=!1,i.emit("stopped_speaking"))}i.speakingHistory.shift(),i.speakingHistory.push(0+(e>u)),g()}}),d)};return g(),i}},function(e,t){function i(){}e.exports=i,i.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,i){this.callbacks=this.callbacks||{};var s=3===arguments.length,n=s?arguments[1]:void 0,r=s?arguments[2]:arguments[1];return r._groupName=n,(this.callbacks[e]=this.callbacks[e]||[]).push(r),this},t.once=function(e,t,i){var s=this,n=3===arguments.length,r=n?arguments[1]:void 0,o=n?arguments[2]:arguments[1];function a(){s.off(e,a),o.apply(this,arguments)}return this.on(e,r,a),this},t.releaseGroup=function(e){var t,i,s,n;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(i=0,s=(n=this.callbacks[t]).length;i<s;i++)n[i]._groupName===e&&(n.splice(i,1),i--,s--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var i,s=this.callbacks[e];return s?1===arguments.length?(delete this.callbacks[e],this):(-1!==(i=s.indexOf(t))&&(s.splice(i,1),0===s.length&&delete this.callbacks[e]),this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,i,s,n=[].slice.call(arguments,1),r=this.callbacks[e],o=this.getWildcardCallbacks(e);if(r)for(t=0,i=(s=r.slice()).length;t<i&&s[t];++t)s[t].apply(this,n);if(o)for(i=o.length,t=0,i=(s=o.slice()).length;t<i&&s[t];++t)s[t].apply(this,[e].concat(n));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,i,s=[];for(t in this.callbacks)i=t.split("*"),("*"===t||2===i.length&&e.slice(0,i[0].length)===i[0])&&(s=s.concat(this.callbacks[t]));return s}},i.mixin(i)},function(e,t,i){(function(e){!function(t){var i=function(e){return n(!0===e,!1,arguments)};function s(e,t){if("object"!==r(e))return t;for(var i in t)"object"===r(e[i])&&"object"===r(t[i])?e[i]=s(e[i],t[i]):e[i]=t[i];return e}function n(e,t,n){var o=n[0],a=n.length;(e||"object"!==r(o))&&(o={});for(var c=0;c<a;++c){var l=n[c];if("object"===r(l))for(var d in l)if("__proto__"!==d){var u=e?i.clone(l[d]):l[d];o[d]=t?s(o[d],u):u}}return o}function r(e){return{}.toString.call(e).slice(8,-1).toLowerCase()}i.recursive=function(e){return n(!0===e,!0,arguments)},i.clone=function(e){var t,s,n=e,o=r(e);if("array"===o)for(n=[],s=e.length,t=0;t<s;++t)n[t]=i.clone(e[t]);else if("object"===o)for(t in n={},e)n[t]=i.clone(e[t]);return n},t?e.exports=i:window.merge=i}(e&&"object"==typeof e.exports&&e.exports)}).call(this,i(29)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,i){t.Interop=i(31)},function(e,t,i){"use strict";var s=i(32),n=i(36);function r(){this.cache={mlB2UMap:{},mlU2BMap:{}}}e.exports=r,r.prototype.candidateToUnifiedPlan=function(e){var t=new RTCIceCandidate(e);return t.sdpMLineIndex=this.cache.mlB2UMap[t.sdpMLineIndex],t},r.prototype.candidateToPlanB=function(e){var t=new RTCIceCandidate(e);if(0===t.sdpMid.indexOf("audio"))t.sdpMid="audio";else{if(0!==t.sdpMid.indexOf("video"))throw new Error("candidate with "+t.sdpMid+" not allowed");t.sdpMid="video"}return t.sdpMLineIndex=this.cache.mlU2BMap[t.sdpMLineIndex],t},r.prototype.getFirstSendingIndexFromAnswer=function(e){if(!this.cache.answer)return null;var t=s.parse(this.cache.answer);if(t&&t.media&&Array.isArray(t.media))for(var i=0;i<t.media.length;i++)if(t.media[i].type==e&&(!t.media[i].direction||"sendrecv"===t.media[i].direction||"sendonly"===t.media[i].direction))return i;return null},r.prototype.toPlanB=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var i=s.parse(e.sdp);if(void 0===i.media||!Array.isArray(i.media)||0===i.media.length)return console.warn("The description has no media."),e;if(i.media.length<=3&&i.media.every((function(e){return-1!==["video","audio","data"].indexOf(e.mid)})))return console.warn("This description does not look like Unified Plan."),e;for(var n=e.sdp,r=!1,o=0;o<i.media.length;o++){i.media[o].rtp.forEach((function(e){if("NULL"===e.codec){r=!0;var i=s.parse(t.cache.offer);e.codec=i.media[o].rtp[0].codec}}))}r&&(n=s.write(i)),this.cache[e.type]=n;var a=i.media;i.media=[];var c={},l=[];a.forEach((function(e){if(("string"!=typeof e.rtcpMux||"rtcp-mux"!==e.rtcpMux)&&"inactive"!==e.direction)throw new Error("Cannot convert to Plan B because m-lines without the rtcp-mux attribute were found.");if(void 0!==c[e.type]&&"inactive"!==c[e.type].direction||(c[e.type]=e),e.protocol!=c[e.type].protocol)throw new Error("Cannot convert to Plan B because m-lines have different protocols and this library does not have support for that");if(e.payloads!=c[e.type].payloads)throw new Error("Cannot convert to Plan B because m-lines have different payloads and this library does not have support for that")})),a.forEach((function(e){if("application"===e.type)return i.media.push(e),void l.push(e.mid);"object"==typeof e.sources&&Object.keys(e.sources).forEach((function(t){"object"!=typeof c[e.type].sources&&(c[e.type].sources={}),c[e.type].sources[t]=e.sources[t],void 0!==e.msid&&(c[e.type].sources[t].msid=e.msid)})),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&(void 0!==c[e.type].ssrcGroups&&Array.isArray(c[e.type].ssrcGroups)||(c[e.type].ssrcGroups=[]),c[e.type].ssrcGroups=c[e.type].ssrcGroups.concat(e.ssrcGroups)),c[e.type]===e&&(e.mid=e.type,delete e.bundleOnly,delete e.msid,e.type==a[0].type?(l.unshift(e.type),i.media.unshift(e)):(l.push(e.type),i.media.push(e)))})),void 0!==i.groups&&i.groups.some((function(e){if("BUNDLE"===e.type)return e.mids=l.join(" "),!0})),i.msidSemantic={semantic:"WMS",token:"*"};var d=s.write(i);return new RTCSessionDescription({type:e.type,sdp:d})},r.prototype.toUnifiedPlan=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var i=s.parse(e.sdp);if(void 0===i.media||!Array.isArray(i.media)||0===i.media.length)return console.warn("The description has no media."),e;if(i.media.length>3||!i.media.every((function(e){return-1!==["video","audio","data"].indexOf(e.mid)})))return console.warn("This description does not look like Plan B."),e;var r=[];i.media.forEach((function(e){r.push(e.mid)}));var o,a,c=!1;if(void 0!==i.groups&&Array.isArray(i.groups)&&(c=i.groups.every((function(e){return"BUNDLE"!==e.type||n.apply(e.mids.sort(),[r.sort()])}))),!c){var l=!1;if(i.media.forEach((function(e){"inactive"!==e.direction&&(l=!0)})),l)throw new Error("Cannot convert to Unified Plan because m-lines that are not bundled were found.")}if("answer"===e.type)o="offer";else{if("offer"!==e.type)throw new Error("Type '"+e.type+"' not supported.");o="answer"}void 0!==this.cache[o]&&(a=s.parse(this.cache[o]));var d,u,p,h,f={audio:{},video:{}},m={},g=0,y=0,v={},w={},S={},b={};if(i.media.forEach((function(i){if(("string"!=typeof i.rtcpMux||"rtcp-mux"!==i.rtcpMux)&&"inactive"!==i.direction)throw new Error("Cannot convert to Unified Plan because m-lines without the rtcp-mux attribute were found.");if("application"!==i.type){var s=i.sources,n=i.ssrcGroups,r=i.port;if(void 0!==i.candidates&&(d=void 0!==d?d.concat(i.candidates):i.candidates),void 0!==u&&void 0!==i.iceUfrag&&u!=i.iceUfrag)throw new Error("Only BUNDLE supported, iceUfrag must be the same for all m-lines.\n\tLast iceUfrag: "+u+"\n\tNew iceUfrag: "+i.iceUfrag);if(void 0!==i.iceUfrag&&(u=i.iceUfrag),void 0!==p&&void 0!==i.icePwd&&p!=i.icePwd)throw new Error("Only BUNDLE supported, icePwd must be the same for all m-lines.\n\tLast icePwd: "+p+"\n\tNew icePwd: "+i.icePwd);if(void 0!==i.icePwd&&(p=i.icePwd),void 0!==h&&void 0!==i.fingerprint&&(h.type!=i.fingerprint.type||h.hash!=i.fingerprint.hash))throw new Error("Only BUNDLE supported, fingerprint must be the same for all m-lines.\n\tLast fingerprint: "+JSON.stringify(h)+"\n\tNew fingerprint: "+JSON.stringify(i.fingerprint));void 0!==i.fingerprint&&(h=i.fingerprint),w[i.type]=i.payloads,S[i.type]=i.rtcpFb,b[i.type]=i.rtp;var o={};void 0!==n&&Array.isArray(n)&&n.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&e.ssrcs.forEach((function(t){void 0===o[t]&&(o[t]=[]),o[t].push(e)}))}));var c={};if("object"==typeof s)delete i.sources,delete i.ssrcGroups,delete i.candidates,delete i.iceUfrag,delete i.icePwd,delete i.fingerprint,delete i.port,delete i.mid,Object.keys(s).forEach((function(n){var l;"offer"!==e.type||s[n].msid?(void 0!==o[n]&&Array.isArray(o[n])&&o[n].some((function(e){return e.ssrcs.some((function(e){if("object"==typeof c[e])return l=c[e],!0}))})),"object"==typeof l?(l.sources[n]=s[n],delete s[n].msid):(l=Object.create(i),c[n]=l,void 0!==s[n].msid&&(l.msid=s[n].msid,delete s[n].msid),l.sources={},l.sources[n]=s[n],l.ssrcGroups=o[n],void 0!==a&&void 0!==a.media&&Array.isArray(a.media)&&a.media.forEach((function(e){"object"==typeof e.sources&&Object.keys(e.sources).forEach((function(t){t===n&&(l.mid=e.mid)}))})),void 0===l.mid&&(l.mid=[i.type,"-",n].join("")),l.candidates=d,l.iceUfrag=u,l.icePwd=p,l.fingerprint=h,l.port=r,m[l.mid]=l,v[y]=l.sources,t.cache.mlU2BMap[y]=g,void 0===t.cache.mlB2UMap[g]&&(t.cache.mlB2UMap[g]=y),y++)):f[i.type][n]=s[n]}));else{var l=i;l.candidates=d,l.iceUfrag=u,l.icePwd=p,l.fingerprint=h,l.port=r,m[l.mid]=l,t.cache.mlU2BMap[y]=g,void 0===t.cache.mlB2UMap[g]&&(t.cache.mlB2UMap[g]=y)}g++}else m[i.mid]=i})),i.media=[],r=[],"answer"===e.type)for(var T=0;T<a.media.length;T++){var I=a.media[T];delete I.msid,delete I.sources,delete I.ssrcGroups,void 0===v[T]?I.direction&&"sendrecv"!==I.direction?"sendonly"===I.direction&&(I.direction="inactive"):I.direction="recvonly":I.direction&&"sendrecv"!==I.direction?"recvonly"===I.direction&&(I.direction="sendonly"):I.direction="sendrecv",I.sources=v[T],I.candidates=d,I.iceUfrag=u,I.icePwd=p,I.fingerprint=h,I.rtp=b[I.type],I.payloads=w[I.type],I.rtcpFb=S[I.type],i.media.push(I),"string"==typeof I.mid&&r.push(I.mid)}else void 0!==a&&void 0!==a.media&&Array.isArray(a.media)&&a.media.forEach((function(e){r.push(e.mid),void 0!==m[e.mid]?i.media.push(m[e.mid]):(delete e.msid,delete e.sources,delete e.ssrcGroups,e.direction&&"sendrecv"!==e.direction||(e.direction="sendonly"),e.direction&&"recvonly"!==e.direction||(e.direction="inactive"),function(e){void 0!==e.setup&&("active"===e.setup?e.setup="passive":"passive"===e.setup&&(e.setup="active"))}(e),i.media.push(e))})),Object.keys(m).forEach((function(e){if(-1===r.indexOf(e))if(r.push(e),"recvonly"===m[e].direction){var t=!1;i.media.some((function(i){if(("sendrecv"===i.direction||"sendonly"===i.direction)&&i.type===m[e].type)return Object.keys(m[e].sources).forEach((function(t){i.sources[t]=m[e].sources[t]})),t=!0,!0})),t||i.media.push(m[e])}else i.media.push(m[e])}));["audio","video"].forEach((function(e){if(i&&i.media&&Array.isArray(i.media)){var s=null;if(Object.keys(f[e]).length>0&&null===(s=t.getFirstSendingIndexFromAnswer(e)))for(var n=0;n<i.media.length;n++)if(i.media[n].type===e){s=n;break}if(s&&i.media.length>s){var r=i.media[s];Object.keys(f[e]).forEach((function(t){r.sources&&r.sources[t]&&console.warn("Replacing an existing SSRC."),r.sources||(r.sources={}),r.sources[t]=f[e][t]}))}}})),void 0!==i.groups&&i.groups.some((function(e){if("BUNDLE"===e.type)return e.mids=r.join(" "),!0})),i.msidSemantic={semantic:"WMS",token:"*"};var D=s.write(i);return this.cache[e.type]=D,new RTCSessionDescription({type:e.type,sdp:D})}},function(e,t,i){var s=i(33);t.write=function(e,t){return void 0!==e&&void 0!==e.media&&Array.isArray(e.media)&&e.media.forEach((function(e){void 0!==e.sources&&0!==Object.keys(e.sources).length&&(e.ssrcs=[],Object.keys(e.sources).forEach((function(t){var i=e.sources[t];Object.keys(i).forEach((function(s){e.ssrcs.push({id:t,attribute:s,value:i[s]})}))})),delete e.sources),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.ssrcs=e.ssrcs.join(" "))}))})),void 0!==e&&void 0!==e.groups&&Array.isArray(e.groups)&&e.groups.forEach((function(e){void 0!==e.mids&&Array.isArray(e.mids)&&(e.mids=e.mids.join(" "))})),s.write(e,t)},t.parse=function(e){var t=s.parse(e);return void 0!==t&&void 0!==t.media&&Array.isArray(t.media)&&t.media.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.sources={},e.ssrcs.forEach((function(t){e.sources[t.id]||(e.sources[t.id]={}),e.sources[t.id][t.attribute]=t.value})),delete e.ssrcs),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach((function(e){"string"==typeof e.ssrcs&&(e.ssrcs=e.ssrcs.split(" "))}))})),void 0!==t&&void 0!==t.groups&&Array.isArray(t.groups)&&t.groups.forEach((function(e){"string"==typeof e.mids&&(e.mids=e.mids.split(" "))})),t}},function(e,t,i){var s=i(34),n=i(35);t.write=n,t.parse=s.parse,t.parseFmtpConfig=s.parseFmtpConfig,t.parsePayloads=s.parsePayloads,t.parseRemoteCandidates=s.parseRemoteCandidates},function(e,t,i){var s=function(e){return String(Number(e))===e?Number(e):e},n=function(e,t,i){var n=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:n&&!t[e.name]&&(t[e.name]={});var r=e.push?{}:n?t[e.name]:t;!function(e,t,i,n){if(n&&!i)t[n]=s(e[1]);else for(var r=0;r<i.length;r+=1)null!=e[r+1]&&(t[i[r]]=s(e[r+1]))}(i.match(e.reg),r,e.names,e.name),e.push&&t[e.push].push(r)},r=i(8),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},i=[],s=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach((function(e){var t=e[0],o=e.slice(2);"m"===t&&(i.push({rtp:[],fmtp:[]}),s=i[i.length-1]);for(var a=0;a<(r[t]||[]).length;a+=1){var c=r[t][a];if(c.reg.test(o))return n(c,s,o)}})),t.media=i,t};var a=function(e,t){var i=t.split("=");return 2===i.length&&(e[i[0]]=s(i[1])),e};t.parseFmtpConfig=function(e){return e.split(/\;\s?/).reduce(a,{})},t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],i=e.split(" ").map(s),n=0;n<i.length;n+=3)t.push({component:i[n],ip:i[n+1],port:i[n+2]});return t}},function(e,t,i){var s=i(8),n=/%[sdv%]/g,r=function(e){var t=1,i=arguments,s=i.length;return e.replace(n,(function(e){if(t>=s)return e;var n=i[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(n);case"%d":return Number(n);case"%v":return""}}))},o=function(e,t,i){var s=[e+"="+(t.format instanceof Function?t.format(t.push?i:i[t.name]):t.format)];if(t.names)for(var n=0;n<t.names.length;n+=1){var o=t.names[n];t.name?s.push(i[t.name][o]):s.push(i[t.names[n]])}else s.push(i[t.name]);return r.apply(null,s)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var i=t.outerOrder||a,n=t.innerOrder||c,r=[];return i.forEach((function(t){s[t].forEach((function(i){i.name in e&&null!=e[i.name]?r.push(o(t,i,e)):i.push in e&&null!=e[i.push]&&e[i.push].forEach((function(e){r.push(o(t,i,e))}))}))})),e.media.forEach((function(e){r.push(o("m",s.m[0],e)),n.forEach((function(t){s[t].forEach((function(i){i.name in e&&null!=e[i.name]?r.push(o(t,i,e)):i.push in e&&null!=e[i.push]&&e[i.push].forEach((function(e){r.push(o(t,i,e))}))}))}))})),r.join("\r\n")+"\r\n"}},function(e,t){e.exports=function e(t){if(!t)return!1;if(this.length!=t.length)return!1;for(var i=0,s=this.length;i<s;i++)if(this[i]instanceof Array&&t[i]instanceof Array){if(!e.apply(this[i],[t[i]]))return!1}else if(this[i]!=t[i])return!1;return!0}},function(e,t){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(2),r=i(1),o=i(3);class a extends s.EventEmitter{constructor(e){super(),this.participants={},this.videoArray=[],this.call_type="video",this.projectID=e.projectId,this.projectSecret=e.secret,this.currentUser=e.currentUser,this.currentRoom=e.room,this.localVideo=e.localVideo,this.container=e.container,this.call_type=e.call_type,this.Authentication(e)}set McToken(e){this.mcToken=e}get McToken(){return this.mcToken}Authentication(e){this.Connect(e.media_server)}Connect(e){var t=new WebSocket(e);t.onmessage=e=>{var t=JSON.parse(e.data);switch(console.log("Received message: "+e.data),t.id){case"existingParticipants":console.log("===yes you====",t),this.OnExistingParticipant(t);break;case"newParticipantArrived":this.onNewParticipant(t);break;case"participantLeft":this.OnParticipantLeft(t);break;case"receiveVideoAnswer":this.ReceiveVideoResponse(t);break;case"iceCandidate":this.participants[t.name].addIceCandidate(t.candidate,(function(e){e&&console.error("Error adding candidate: "+e)}));break;case"ping":this.SendPacket({requestType:"pong",mcToken:this.McToken});break;default:console.error("Unrecognized message",t)}},t.onclose=e=>{n.default.OnDisconnection(e,this),console.log("OnClose socket==",e)},t.onopen=e=>{this.Register(),n.default.OnConnection(e,this),console.log("OnOpen socket==",e)},t.onerror=e=>{n.default.OnDisconnection(e,this),console.log("OnError socket==",e)},this.ws=t}OnExistingParticipant(e){let t={mandatory:{maxFrameRate:15,minFrameRate:15}};"video"!=this.call_type&&(t=!1);var i={audio:!0,video:t};r.SetPlaysInline(this.localVideo);var s={localVideo:this.localVideo,mediaConstraints:i,onicecandidate:e=>{var t={id:"onIceCandidate",candidate:e,name:this.currentUser};this.SendPacket(t)}};let n=new o.WebRtcPeer.WebRtcPeerSendonly(s,e=>{if(e)return console.error(e);n.generateOffer((e,t,i)=>{if(e)return console.error("sdp offer error");var s={id:"receiveVideoFrom",sender:this.currentUser,sdpOffer:t};this.SendPacket(s)})});this.participants[this.currentUser]=n,e.data.forEach(e=>{this.emit("groupCall",{type:"NEW_PARTICIPANT",message:"Participant List",participant:e})})}SetParticipantVideo(e,t){r.SetPlaysInline(e);var i={remoteVideo:e,onicecandidate:e=>{var i={id:"onIceCandidate",candidate:e,name:t};this.SendPacket(i)}};let s=new o.WebRtcPeer.WebRtcPeerRecvonly(i,e=>{if(e)return console.error(e);s.generateOffer((e,i)=>{if(e)return console.error("sdp offer error");console.log("Invoking SDP offer callback function");var s={id:"receiveVideoFrom",sender:t,sdpOffer:i};this.SendPacket(s)})});this.participants[t]=s}onNewParticipant(e){this.emit("groupCall",{type:"NEW_PARTICIPANT",message:"Participant has joined",participant:e.name})}OnParticipantLeft(e){this.emit("groupCall",{type:"PARTICIPANT_LEFT",message:"Participant has left",participant:e.name});var t=this.participants[e.name];t&&null!=t&&(t.dispose(),delete this.participants[e.name])}ReceiveVideoResponse(e){let t=this.participants[e.name];console.log("===ongroupcall==recievresp==",e,"participant",this.participants),t&&null!=t&&t.processAnswer(e.sdpAnswer,(function(e){if(e)return console.error(e)}))}OnIceCandidate(e){let t=this.participants[e.name];null!=t&&t.addIceCandidate(e.candidate,(function(e){e&&console.error("Error adding candidate: "+e)}))}LeaveRoom(){for(var e in this.SendPacket({id:"leaveRoom"}),this.participants){let t=this.participants[e];t&&null!=t&&t.dispose()}this.ws.close()}Close(){}Register(){var e={id:"joinRoom",name:this.currentUser,room:this.currentRoom};this.SendPacket(e)}SendPacket(e){var t=JSON.stringify(e);console.log("Sending message: "+t),null!=this.ws?this.ws.send(t):n.default.OnAuthInitialError("",this)}SetMicMute(){let e=this.localVideo;null!=e&&null!=e&&(e.srcObject.getAudioTracks()[0].enabled=!1);var t={id:"media_status",status:{type:"mic",status:0,username:this.currentUser}};this.SendPacket(t)}SetMicUnmute(){let e=this.localVideo;null!=e&&null!=e&&(e.srcObject.getAudioTracks()[0].enabled=!0);var t={id:"media_status",status:{type:"mic",status:1,username:this.currentUser}};this.SendPacket(t)}SetCameraOn(){let e=this.localVideo;null!=e&&null!=e&&(e.srcObject.getVideoTracks()[0].enabled=!0);var t={id:"media_status",status:{type:"camera",status:1,username:this.currentUser}};this.SendPacket(t)}SetCameraOff(){let e=this.localVideo;null!=e&&null!=e&&(e.srcObject.getVideoTracks()[0].enabled=!1);var t={id:"media_status",status:{type:"camera",status:0,username:this.currentUser}};this.SendPacket(t)}GetContainer(){let e=document.createElement("section");for(var t in this.participants){let i=this.participants[t].getVideoElement(),s=this.participants[t].createVideo(i.srcObject);e.appendChild(s)}return e}}t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(2),r=i(4),o=i(5),a=i(6),c=i(7),l=i(1),d=i(3);class u extends s.EventEmitter{constructor(e){super(),this.UUIDSessions={},this.UUIDSessionTypes={},this.UUIDSessionMediaTypes={},this.participants={},this.participantVideo={},this.callSession="",this.participatArray=[],this.mediaType="",this.projectID=e.projectID,this.projectSecret=e.secret,e.host?this.Connect(e.host):this.Authentication(e)}set McToken(e){this.mcToken=e}get McToken(){return this.mcToken}Authentication(e){console.log("====DER===",e,this.projectID,this.projectSecret,this.clientToken),r.default.Authorization(e.projectID,e.secret).then(e=>{if(console.log("===Authorization-outer===",e),e&&200==e.status){let t=`${e.media_server_map.protocol}://${e.media_server_map.host}:${e.media_server_map.port}/${e.media_server_map.end_point}`;this.Connect(t),console.log("===Authorization===",e)}else n.default.OnAuthError(e.message,this)})}Connect(e){var t=new WebSocket(e);t.onmessage=e=>{var t=JSON.parse(e.data);switch(console.log("Received message: ",t),t.requestType){case"register":a.default.SetRegisterResponse(t,this);break;case"callResponse":console.log(" CallResponse: ",t),this.CallResponse(t);break;case"incomingCall":this.callSession=t.sessionUUID,this.mediaType=t.media_type,console.log("incomingCall case: ",e),n.default.OnIncomingGroupCall(t,this);break;case"startCommunication":this.SessionStart(t);break;case"stopCommunication":console.info("Communication ended by remote peer",t);break;case"iceCandidate":this.AddCandidate(t);break;case"session_invite":break;case"session_cancel":this.OnSessionCancel(t),console.log("===onParticipantOffer== exiting session_cancel",t,(new Date).toLocaleTimeString());break;case"existing_participants":console.log("===onParticipantOffer== exiting",t,(new Date).toLocaleTimeString()),this.OnExistingParticipants(t);break;case"new_participant_arrived":console.log("===onParticipantOffer== exiting new",t,(new Date).toLocaleTimeString()),this.OnNewParticipant(t);break;case"participantLeft":console.log("===onParticipantOffer== exiting left",t,(new Date).toLocaleTimeString()),this.OnParticipantLeft(t);break;case"state_information":console.log("===onParticipantOffer== exiting left",t,(new Date).toLocaleTimeString()),n.default.SetParticipantStatus(t,this);break;case"ping":this.SendPacket({requestType:"pong",mcToken:this.McToken})}},t.onclose=e=>{n.default.OnDisconnection(e,this),console.log("OnClose socket==",e)},t.onopen=e=>{n.default.OnConnection(e,this),console.log("OnOpen socket==",e)},t.onerror=e=>{n.default.OnDisconnection(e,this),console.log("OnError socket==",e)},this.ws=t}AddCandidate(e){console.log("Add Ice Candidate::::",e,this.participants[e.referenceID]),this.participants[e.referenceID].addIceCandidate(e.candidate,e=>{if(e)return n.default.OnAddCandidate(e,this),console.error("Error adding candidate: "+e)})}OnExistingParticipants(e){let t=e.referenceIDs;t.forEach(e=>{null!=e&&this.emit("groupCall",{type:"NEW_PARTICIPANT",message:"New participant arrived.",participant:e})})}OnSessionCancel(e){let t=e.referenceID;this.emit("groupCall",{type:"PARTICIPANT_LEFT",message:"Participant left.",participant:t});var i=this.participants[t];this.participatArray.splice(this.participatArray.indexOf(t),1),i&&null!=i&&i.dispose(),delete this.participants[t],delete this.participantVideo[t]}OnNewParticipant(e){let t=e.referenceID;null!=t&&-1==this.participatArray.indexOf(t)&&this.emit("groupCall",{type:"NEW_PARTICIPANT",message:"New participant arrived.",participant:t})}OnParticipantLeft(e){let t=e.referenceID;this.emit("groupCall",{type:"PARTICIPANT_LEFT",message:"Participant left.",participant:t})}SetParticipantVideo(e,t){l.SetPlaysInline(t);let i={remoteVideo:t,onicecandidate:t=>{this.OnParticipantIceCandidate(t,e)},onerror:this.onError},s=new d.WebRtcPeer.WebRtcPeerRecvonly(i,t=>{if(t)return console.error(t);s.generateOffer((t,i)=>{this.onParticipantOffer(t,i,e)})});return this.participants[e]=s,this.participantVideo[e]=t,t}ExistingParticipant(e){var t;let i=document.createElement("video");i.autoplay=!0,i.muted=!0,i.style.display="none";let s={remoteVideo:i,onicecandidate:t=>{this.OnParticipantIceCandidate(t,e)},onerror:this.onError},n=new d.WebRtcPeer.WebRtcPeerRecvonly(s,t=>{if(t)return console.error(t);n.generateOffer((t,i)=>{this.onParticipantOffer(t,i,e)})});return this.participants[e]=n,this.participantVideo[e]=i,null===(t=document.getElementById("hellofyou"))||void 0===t||t.appendChild(i),i}CallResponse(e){console.info("CallResponse",this.participants[e.referenceID],e),"accepted"==e.response&&this.participants[e.referenceID].processAnswer(e.sdpAnswer,e=>{if(e)return n.default.SessionSDP(e,this),console.error(e)})}SessionStart(e){n.default.SessionStart(e,this),console.log("Start=Commm",e.referenceID,e.referenceID,this.participants[e.referenceID]),this.participants[e.referenceID].processAnswer(e.sdpAnswer,e=>{if(e)return n.default.SessionSDP(e,this),console.error(e)})}onOfferIncomingCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the offer");let s={type:"request",requestType:"session_invite",sdpOffer:t,requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,referenceID:this.currentUser,responseCode:200,responseMessage:"accepted"};console.log("===OnOffering Answer",s),this.SendPacket(s)}OnOfferManytoManyCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the offer");let s={type:"request",requestType:"session_invite",sdpOffer:t,requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,referenceID:this.currentUser,responseCode:200,responseMessage:"accepted"};console.log("===OnOffering Answer",s),this.SendPacket(s)}Register(e,t){this.currentUser=e;let i=new o.default;i.requestID=(new Date).getTime().toString(),i.tenantID=this.projectID,i.referenceID=e,i.authorizationToken=t,i.SendRegisterRequest(this.ws)}GroupCall(e){this.mediaType=e.call_type,this.to=Array.isArray(e.to)?e.to:[e.to],this.currentFromUser=this.currentUser,this.localVideo=e.localVideo,l.SetPlaysInline(this.localVideo);var t={mediaConstraints:{audio:!0,video:"audio"!=e.call_type},localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};let i=new d.WebRtcPeer.WebRtcPeerSendonly(t,t=>{if(t)return console.error(t);i.generateOffer((t,i)=>{this.onManyToManyOfferCall(t,i,e.call_type)})});this.participants[this.currentUser]=i}JoinGroupCall(e){this.mediaType=e.call_type,this.localVideo=e.localVideo,l.SetPlaysInline(this.localVideo);var t={mediaConstraints:{audio:!0,video:"audio"!=e.call_type},localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentFromUser)},onerror:this.onError};let i=new d.WebRtcPeer.WebRtcPeerSendonly(t,t=>{if(t)return console.error(t);i.generateOffer((t,i)=>{console.log("======here===it goes inner sess",this.callSession),this.onJoinManyToManyOfferCall(t,i,e.call_type)}),console.log("======here===it goes")});this.participants[this.currentUser]=i}Broadcasting(e){this.to=e.to,this.currentFromUser=this.currentUser,this.localVideo=e.localVideo;var t={localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new d.WebRtcPeer.WebRtcPeerSendonly(t,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferOneToManyCall(e,t)})})}onOfferOneToManyCall(e,t){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let i=(new Date).getTime().toString();this.UUIDSessions[this.currentUser]=i,this.UUIDSessionTypes[i]="one_to_many";let s=new c.default;s.from=this.currentUser,s.to=this.to,s.requestID=i,s.sessionUUID=i,s.mcToken=this.McToken,s.sdpOffer=t,s.call_type="one_to_many",s.SendCallRequest(this.ws)}AcceptBroadcast(e){let t=this.currentFromUser;var i={remoteVideo:e,onicecandidate:e=>{this.onIceCandidate(e,t)},onerror:this.onError};this.webRtcPeer=new d.WebRtcPeer.WebRtcPeerRecvonly(i,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,i)=>{this.onOfferIncomingCall(e,i,t)})})}onOfferCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let s=(new Date).getTime().toString(),r=new c.default;r.from=this.currentUser,r.to=this.to,r.requestID=s,r.sessionUUID=s,r.mcToken=this.McToken,r.sdpOffer=t,r.media_type=i,r.SendCallRequest(this.ws),this.UUIDSessions[this.currentUser]=s,this.UUIDSessionTypes[s]="one_to_one",console.log(" OnOfferCall :: :: ::",i)}onManyToManyOfferCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let s=(new Date).getTime().toString();this.callSession=s;let r=new c.default;r.from=this.currentUser,r.to=this.to,r.requestID=s,r.sessionUUID=s,r.mcToken=this.McToken,r.sdpOffer=t,r.media_type=i,r.call_type="many_to_many",r.SendCallRequest(this.ws),console.log(" OnOfferCall :: :: ::",i)}onJoinManyToManyOfferCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);console.log("======here===it goes inner",i);let s=(new Date).getTime().toString(),r=this.callSession;console.log("======here===it goes sess",r);var o={from:this.currentUser,sdpOffer:t,responseCode:200,responseMessage:"accepted",requestType:"session_invite",type:"request",session_type:"call",call_type:"many_to_many",media_type:i,requestID:s,sessionUUID:this.callSession,mcToken:this.mcToken};this.SendPacket(o)}onParticipantOffer(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let s=(new Date).getTime().toString();var r={from:this.currentUser,to:i,requestType:"to_receive_stream",sdpOffer:t,requestID:s,type:"request",sessionUUID:this.callSession,mcToken:this.McToken};console.log("===onParticipantOffer==",r),this.SendPacket(r)}DisposeWebrtc(e){for(var t in this.participants){let e=this.participants[t];e&&null!=e&&e.dispose()}this.participants={},this.participantVideo={},this.callSession="",this.participatArray=[]}onError(e){n.default.OnRTCPeer(e,this)}onIceCandidate(e,t){console.log("Local candidate"+JSON.stringify(e));var i={requestType:"onIceCandidate",candidate:e,referenceID:t,sessionUUID:this.callSession};this.SendPacket(i)}SendPacket(e){var t=JSON.stringify(e);console.log("Sending message: "+t),null!=this.ws?this.ws.send(t):n.default.OnAuthInitialError("",this)}OnParticipantIceCandidate(e,t){var i={requestType:"onIceCandidate",candidate:e,referenceID:t,sessionUUID:this.callSession};this.SendPacket(i)}SetMicMute(){if(this.localVideo&&null!=this.localVideo){let e="video"==this.mediaType?1:0,t={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:0,videoInformation:e};this.SendPacket(t),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!1),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!1)}}SetMicUnmute(){if(this.localVideo&&null!=this.localVideo){let e="video"==this.mediaType?1:0,t={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:e};this.SendPacket(t),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!0),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!0)}}SetCameraOn(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:1};this.SendPacket(e),this.localVideo.srcObject.getVideoTracks()[0].enabled=!0}}SetCameraOff(){if(this.localVideo&&null!=this.localVideo){let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken,referenceID:this.currentUser,audioInformation:1,videoInformation:0};this.SendPacket(e),this.localVideo.srcObject.getVideoTracks()[0].enabled=!1}}LeaveGroupCall(){let e={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.callSession,mcToken:this.McToken};this.SendPacket(e),this.DisposeWebrtc(!1)}CancelCall(){let e=this.currentFromUser,t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[e],mcToken:this.McToken};this.SendPacket(t),this.DisposeWebrtc(!1)}}t.default=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(0),n=i(2),r=i(4),o=i(5),a=i(6),c=i(7),l=i(1),d=i(3);class u extends s.EventEmitter{constructor(e){super(),this.UUIDSessions={},this.UUIDSessionTypes={},this.UUIDSessionMediaTypes={},this.videoStatus=1,this.audioStatus=1,this.broadCastSession={},this.projectID=e.projectID,this.projectSecret=e.secret,e.host?this.Connect(e.host):this.Authentication(e)}set McToken(e){this.mcToken=e}get McToken(){return this.mcToken}Authentication(e){console.log("====DER===",e,this.projectID,this.projectSecret,this.clientToken),r.default.Authorization(e.projectID,e.secret).then(e=>{if(console.log("===Authorization-outer===",e),e&&200==e.status){let t=`${e.media_server_map.protocol}://${e.media_server_map.host}:${e.media_server_map.port}/${e.media_server_map.end_point}`;this.Connect(t),console.log("===Authorization===",e)}else n.default.OnAuthError(e.message,this)})}Connect(e){var t=new WebSocket(e);t.onmessage=e=>{var t=JSON.parse(e.data);switch(console.log("Received message: ",t),t.requestType){case"register":case"registerURL":a.default.SetRegisterResponse(t,this);break;case"callResponse":console.log(" CallResponse: ",t),this.CallResponse(t),n.default.OnCallResponse(t,this);break;case"incomingCall":this.callSession=t.sessionUUID,this.currentFromUser=t.from,this.UUIDSessions[t.from]=t.sessionUUID,this.UUIDSessionTypes[t.sessionUUID]=t.call_type,this.UUIDSessionMediaTypes[t.from]=t.media_type,this.mediaType=t.media_type,console.log("incomingCall case: ",e),n.default.OnIncomingCall(t,this);break;case"startCommunication":this.SessionStart(t);break;case"stopCommunication":console.info("Communication ended by remote peer"),n.default.SessionEnd(t,this),this.DisposeWebrtc(!0);break;case"iceCandidate":this.AddCandidate(t);break;case"session_invite":break;case"session_cancel":n.default.SessionCancel(t,this);break;case"state_information":console.log("===onParticipantOffer== exiting left",t,(new Date).toLocaleTimeString()),n.default.SetCallerStatus(t,this);break;case"ping":this.SendPacket({requestType:"pong",mcToken:this.McToken})}},t.onclose=e=>{n.default.OnDisconnection(e,this),console.log("OnClose socket==",e)},t.onopen=e=>{n.default.OnConnection(e,this),console.log("OnOpen socket==",e)},t.onerror=e=>{n.default.OnDisconnection(e,this),console.log("OnError socket==",e)},this.ws=t}AddCandidate(e){this.broadCastSession[e.sessionUUID].addIceCandidate(e.candidate,e=>{if(e)return n.default.OnAddCandidate(e,this),console.error("Error adding candidate: "+e)})}CallResponse(e){console.info("CallResponse",this.webRtcPeer,e),"accepted"==e.response&&this.broadCastSession[e.sessionUUID].processAnswer(e.sdpAnswer,e=>{if(e)return n.default.SessionSDP(e,this),console.error(e)})}SessionStart(e){n.default.SessionStart(e,this),this.broadCastSession[e.sessionUUID].processAnswer(e.sdpAnswer,e=>{if(e)return n.default.SessionSDP(e,this),console.error(e)})}AcceptCall(e,t){this.localVideo=e;let i=this.currentFromUser;var s={mediaConstraints:{audio:!0,video:"audio"!=this.mediaType},localVideo:e,remoteVideo:t,onicecandidate:e=>{this.onIceCandidate(e,i)},onerror:this.onError};this.webRtcPeer=new d.WebRtcPeer.WebRtcPeerSendrecv(s,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferIncomingCall(e,t,i)})})}RejectCall(e){let t=this.currentFromUser,i={type:"response",from:t,requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[t],responseCode:496,responseMessage:"rejected"};this.SendPacket(i),this.DisposeWebrtc(!1)}onOfferIncomingCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the offer");let s={type:"request",requestType:"session_invite",sdpOffer:t,requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[i],responseCode:200,responseMessage:"accepted"};console.log("===OnOffering Answer",s),this.SendPacket(s)}onOfferPublicUrlCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the offer");let s={type:"request",requestType:"publicURL",sdpOffer:t,requestID:(new Date).getTime().toString(),sessionUUID:i,responseCode:200,responseMessage:"accepted"};console.log("===OnOffering Answer",s),this.SendPacket(s)}Register(e,t){this.currentUser=e;let i=new o.default;i.requestID=(new Date).getTime().toString(),i.tenantID=this.projectID,i.referenceID=e,i.authorizationToken=t,i.SendRegisterRequest(this.ws)}RegisterPublicURL(){let e=l.UuidGenerator();this.currentUser=e;let t=new o.default;t.requestID=(new Date).getTime().toString(),t.tenantID=this.projectID,t.referenceID=e,t.requestType="registerURL",t.SendRegisterRequest(this.ws)}Call(e){this.mediaType="video",this.to=Array.isArray(e.to)?e.to:[e.to],this.currentFromUser=this.currentUser,this.localVideo=e.localVideo,l.SetPlaysInline(this.localVideo);var t={localVideo:e.localVideo,remoteVideo:e.remoteVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new d.WebRtcPeer.WebRtcPeerSendrecv(t,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferCall(e,t,"video")})})}AudioCall(e){this.mediaType="audio",this.to=Array.isArray(e.to)?e.to:[e.to],this.currentFromUser=this.currentUser,this.localVideo=e.localVideo,l.SetPlaysInline(this.localVideo);var t={localVideo:e.localVideo,remoteVideo:e.remoteVideo,mediaConstraints:{audio:!0,video:!1},onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new d.WebRtcPeer.WebRtcPeerSendrecv(t,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferCall(e,t,"audio")})})}Broadcasting(e){this.mediaType="video",this.to=e.to,this.currentFromUser=this.currentUser,this.localVideo=e.localVideo,l.SetPlaysInline(this.localVideo);var t={localVideo:e.localVideo,onicecandidate:e=>{this.onIceCandidate(e,this.currentUser)},onerror:this.onError};this.webRtcPeer=new d.WebRtcPeer.WebRtcPeerSendonly(t,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,t)=>{this.onOfferOneToManyCall(e,t)})})}onOfferOneToManyCall(e,t){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let i=(new Date).getTime().toString();this.UUIDSessions[this.currentUser]=i,this.UUIDSessionTypes[i]="one_to_many";let s=new c.default;s.from=this.currentUser,s.to=this.to,s.requestID=i,s.sessionUUID=i,s.mcToken=this.McToken,s.sdpOffer=t,s.call_type="one_to_many",s.SendCallRequest(this.ws)}AcceptBroadcast(e){let t=this.currentFromUser;this.mediaType="video",l.SetPlaysInline(e);var i={remoteVideo:e,onicecandidate:e=>{this.onIceCandidate(e,t)},onerror:this.onError};this.webRtcPeer=new d.WebRtcPeer.WebRtcPeerRecvonly(i,e=>{if(e)return console.error(e);this.webRtcPeer.generateOffer((e,i)=>{this.onOfferIncomingCall(e,i,t)})})}AcceptPublicBroadcast(e,t){this.mediaType="video";l.SetPlaysInline(e);var i={remoteVideo:e,onicecandidate:e=>{this.onPublicIceCandidate(e,this.currentUser,t)},onerror:this.onError};let s=new d.WebRtcPeer.WebRtcPeerRecvonly(i,e=>{if(e)return console.error(e);s.generateOffer((e,i)=>{this.onOfferPublicUrlCall(e,i,t)})});this.broadCastSession[t]=s}onOfferCall(e,t,i){if(e)return n.default.OnOfferIncomingCall(e,this),console.error("Error generating the call offer ",e);let s=(new Date).getTime().toString(),r=new c.default;r.from=this.currentUser,r.to=this.to,r.requestID=s,r.sessionUUID=s,r.mcToken=this.McToken,r.sdpOffer=t,r.media_type=i,r.SendCallRequest(this.ws),this.UUIDSessions[this.currentUser]=s,this.UUIDSessionTypes[s]="one_to_one",console.log(" OnOfferCall :: :: ::",i)}DisposeWebrtc(e){if(this.webRtcPeer){if(this.webRtcPeer.dispose(),this.webRtcPeer=null,e){var t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[this.currentFromUser],mcToken:"f3101a4f686d4dd7993ded88d9e386e5"};this.SendPacket(t)}let i=this.UUIDSessions[this.currentFromUser];delete this.UUIDSessionTypes[i],delete this.UUIDSessions[this.currentFromUser]}}onError(e){n.default.OnRTCPeer(e,this)}onPublicIceCandidate(e,t,i){console.log("Local candidate"+JSON.stringify(e));var s={id:"onIceCandidate",requestType:"onIceCandidate",type:"request",candidate:e,referenceID:t,sessionUUID:i};this.SendPacket(s)}onIceCandidate(e,t){console.log("Local candidate"+JSON.stringify(e));var i={id:"onIceCandidate",requestType:"onIceCandidate",type:"request",candidate:e,referenceID:t,sessionUUID:this.UUIDSessions[t]};this.SendPacket(i)}SendPacket(e){var t=JSON.stringify(e);console.log("Sending message: "+t),null!=this.ws?this.ws.send(t):n.default.OnAuthInitialError("",this)}EndCall(){let e=this.currentFromUser,t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[e],mcToken:this.McToken};this.SendPacket(t),this.DisposeWebrtc(!1)}CancelCall(){let e=this.currentFromUser,t={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[e],mcToken:this.McToken};this.SendPacket(t),this.DisposeWebrtc(!1)}EndBroadCasting(){this.currentFromUser;let e=Object.assign({},this.broadCastSession);for(var t in e){let i=e[t],s={type:"request",requestType:"session_cancel",requestID:(new Date).getTime().toString(),sessionUUID:t,mcToken:this.McToken};this.SendPacket(s),i.dispose(),delete this.broadCastSession[t]}}SetMicMute(){if(this.localVideo&&null!=this.localVideo){let e="video"==this.mediaType&&1==this.videoStatus?1:0;this.audioStatus=0;let t={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[this.currentFromUser],mcToken:this.McToken,referenceID:this.currentUser,audioInformation:this.audioStatus,videoInformation:e};this.SendPacket(t),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!1),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!1)}}SetMicUnmute(){if(this.localVideo&&null!=this.localVideo){let e="video"==this.mediaType&&1==this.videoStatus?1:0;this.audioStatus=1;let t={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[this.currentFromUser],mcToken:this.McToken,referenceID:this.currentUser,audioInformation:this.audioStatus,videoInformation:e};this.SendPacket(t),null!=this.localVideo.srcObject&&(this.localVideo.srcObject.getAudioTracks()[0].enabled=!0),"audio"==this.localVideo.localName&&(this.localVideo.audioTracks[0].enabled=!0)}}SetCameraOn(){if(this.localVideo&&null!=this.localVideo){this.videoStatus=1;let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[this.currentFromUser],mcToken:this.McToken,referenceID:this.currentUser,audioInformation:this.audioStatus,videoInformation:1};this.SendPacket(e),this.localVideo.srcObject.getVideoTracks()[0].enabled=!0}}SetCameraOff(){if(this.localVideo&&null!=this.localVideo){this.videoStatus=0;let e={requestType:"state_information",type:"request",requestID:(new Date).getTime().toString(),sessionUUID:this.UUIDSessions[this.currentFromUser],mcToken:this.McToken,referenceID:this.currentUser,audioInformation:this.audioStatus,videoInformation:0};this.SendPacket(e),this.localVideo.srcObject.getVideoTracks()[0].enabled=!1}}}t.default=u}])}));